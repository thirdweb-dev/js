!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Klee=t():e.Klee=t()}(self,(()=>(()=>{"use strict";var e,t,i={},s={};function n(e){var t=s[e];if(void 0!==t)return t.exports;var r=s[e]={exports:{}};return i[e](r,r.exports,n),r.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(i,s){if(1&s&&(i=this(i)),8&s)return i;if("object"==typeof i&&i){if(4&s&&i.__esModule)return i;if(16&s&&"function"==typeof i.then)return i}var r=Object.create(null);n.r(r);var o={};e=e||[null,t({}),t([]),t(t)];for(var l=2&s&&i;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>o[e]=()=>i[e]));return o.default=()=>i,n.d(r,o),r},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r,o,l,a={};n.r(a),n.d(a,{Klee:()=>je,get:()=>qe,init:()=>Ye});class c{constructor(e){this._element=e,this._context=this._element.getContext("2d",{alpha:!1}),this._PI_TIMES_TWO=2*Math.PI}getBoundingClientRect(){return this._element.getBoundingClientRect()}fillStyle(e){return this._context.fillStyle=e,this}strokeStyle(e){return this._context.strokeStyle=e,this}beginPath(){return this._context.beginPath(),this}closePath(){return this._context.closePath(),this}drawImage(e,t,i,s,n){return this._context.drawImage(e,t,i,s,n),this}roundedRectangle(e,t,i,s,n){let r,o,l,a;if(n instanceof Object){let e=n;r=e.radiusTopLeft,o=e.radiusTopRight,l=e.radiusBottomLeft,a=e.radiusBottomRight}else r=n,o=n,l=n,a=n;return this._context.beginPath(),this._context.moveTo(e+r,t),this._context.lineTo(e+i-o,t),this._context.quadraticCurveTo(e+i,t,e+i,t+o),this._context.lineTo(e+i,t+s-a),this._context.quadraticCurveTo(e+i,t+s,e+i-a,t+s),this._context.lineTo(e+l,t+s),this._context.quadraticCurveTo(e,t+s,e,t+s-l),this._context.lineTo(e,t+r),this._context.quadraticCurveTo(e,t,e+r,t),this._context.closePath(),this}lineTo(e,t){return this._context.lineTo(e,t),this}quadraticCurveTo(e,t,i,s){return this._context.quadraticCurveTo(e,t,i,s),this}fill(e,t){return e instanceof Path2D?this._context.fill(e,t):void 0!==e?this._context.fill(e):this._context.fill(),this}stroke(e){return null!=e?this._context.stroke(e):this._context.stroke(),this}clear(){return this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._element.width,this._element.height),this}translate(e,t){return this._context.translate(e,t),this}fillRect(e,t,i,s){return this._context.fillRect(e,t,i,s),this}strokeRect(e,t,i,s){return this._context.strokeRect(e,t,i,s),this}setLineDash(e){return this._context.setLineDash(e),this}fillCircle(e,t,i){return this._context.beginPath(),this._context.arc(e,t,i,0,this._PI_TIMES_TWO),this._context.fill(),this}strokeCircle(e,t,i){return this._context.beginPath(),this._context.arc(e,t,i,0,this._PI_TIMES_TWO),this._context.stroke(),this}fillText(e,t,i,s){return this._context.fillText(e,t,i,s),this}strokeText(e,t,i,s){return this._context.strokeText(e,t,i,s),this}shadow(e,t,i){return this._context.shadowOffsetX=e.x,this._context.shadowOffsetY=e.y,this._context.shadowBlur=t,this._context.shadowColor=i,this}lineWidth(e){return this._context.lineWidth=e,this}moveTo(e,t){return this._context.moveTo(e,t),this}bezierCurveTo(e,t,i,s,n,r){return this._context.bezierCurveTo(e,t,i,s,n,r),this}save(){return this._context.save(),this}restore(){return this._context.restore(),this}font(e){return this._context.font=e,this}textAlign(e){return this._context.textAlign=e,this}getContext(){return this._context}get width(){return this._element.width}get height(){return this._element.height}}class h{static checkIntersection(e,t,i,s){return this.absRect(e,t),this.absRect(i,s),e.x<i.x+s.x&&e.x+t.x>i.x&&e.y<i.y+s.y&&e.y+t.y>i.y}static absRect(e,t){t.x<0&&(e.x+=t.x,t.x=Math.abs(t.x)),t.y<0&&(e.y+=t.y,t.y=Math.abs(t.y))}}class d{constructor(e,t){this.x=e,this.y=t}add(e){return new d(this.x+e.x,this.y+e.y)}subtract(e){return new d(this.x-e.x,this.y-e.y)}divide(e){return new d(this.x/e.x,this.y/e.y)}multiply(e){return e instanceof d?new d(this.x*e.x,this.y*e.y):new d(this.x*e,this.y*e)}toString(){return`Vector2(x: ${this.x}, y: ${this.y})`}copy(){return new d(this.x,this.y)}}function p(e){const t=e;return void 0!==t.onMouseDown&&void 0!==t.onMouseUp&&void 0!==t.onMouseEnter&&void 0!==t.onMouseLeave&&void 0!==t.onMouseMove}!function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"}(r||(r={}));class u{constructor(e,t){this._actions=[],this.hoveredControls=[],this.app=t,this._element=e,Xe.isFirefox&&(this._element.setAttribute("contenteditable",""),this._element.style.cursor="default",this._element.style.color="transparent"),e.tabIndex=0,e.onmousedown=e=>this.onMouseDown(e),e.onmouseup=e=>this.onMouseUp(e),e.onmousemove=e=>this.onMouseMove(e),e.onmouseenter=e=>this.onMouseEnter(e),e.onmouseleave=e=>this.onMouseLeave(e),e.onkeydown=e=>this.onKeydown(e),e.oncontextmenu=e=>this.onContextMenu(e),this.registerAction({ctrl:!0,keycode:"KeyA",callback:this.selectAllNodes.bind(this)})}registerAction(e){this._actions.push(e)}onKeydown(e){for(const t of this._actions.filter((t=>t.keycode===e.code)))t.ctrl===e.ctrlKey&&t.callback(e)&&e.preventDefault()}onMouseDown(e){this._mouseDownData={buttonType:e.button,position:this.getMousePosition(e)},this._mousePositionOfPreviousMove=this._mouseDownData.position;const t=this.getAbsoluteMousePosition(e);let i=this.getIntersectingControls(t,new d(0,0));i=i.sort(((e,t)=>e.ZIndex-t.ZIndex));for(let t of i)if(t.onMouseDown(e))break;for(let t of this.hoveredControls)i.indexOf(t)<0&&(this.hoveredControls.splice(this.hoveredControls.indexOf(t),1),p(t)&&t.onMouseLeave(e))}onMouseUp(e){const t=this.getMousePosition(e),i=this.getAbsoluteMousePosition(e);let s=!1,n=this.getIntersectingControls(i,new d(0,0));n=n.sort(((e,t)=>e.ZIndex-t.ZIndex));for(let t of n)if(p(t)&&(s=t.onMouseUp(e)))break;for(let t of this.hoveredControls)n.indexOf(t)<0&&(this.hoveredControls.splice(this.hoveredControls.indexOf(t),1),p(t)&&t.onMouseLeave(e));if(this._mouseDownData&&!s){const e=t.subtract(this._mouseDownData.position);0==e.x&&0==e.y&&(this.app.scene.nodes.forEach((e=>e.selected=!1)),this.selectIntersectingControls(i,new d(0,0)))}this._mouseDownData=null,this.app.scene.refresh()}onMouseMove(e){const t=this.getMousePosition(e),i=this.getAbsoluteMousePosition(e);if(this._mouseDownData){if(this._mouseDownData.buttonType===r.Right){const e=t.subtract(this._mousePositionOfPreviousMove);return this._mousePositionOfPreviousMove=t,this.app.scene.camera.moveRelative(e),this.app.scene.refresh(),!1}if(this._mouseDownData.buttonType===r.Left){const i=t.subtract(this._mouseDownData.position);this.app.scene.refresh();const s=this.getAbsoluteMouseDownPosition(e);return this.drawMouseSelection(s.x,s.y,i.x,i.y),this.selectIntersectingControls(s,i),!1}}let s=this.getIntersectingControls(i,new d(0,0));for(let t of s)this.hoveredControls.indexOf(t)<0&&(this.hoveredControls.push(t),p(t)&&t.onMouseEnter(e));s=s.sort(((e,t)=>e.ZIndex-t.ZIndex));for(let t of s)if(p(t)&&t.onMouseMove(e))break;for(let t of this.hoveredControls)s.indexOf(t)<0&&(this.hoveredControls.splice(this.hoveredControls.indexOf(t),1),p(t)&&t.onMouseLeave(e));return!1}onMouseEnter(e){0==e.buttons&&(this._mouseDownData=null)}onMouseLeave(e){if(this._mouseDownData&&this._mouseDownData.buttonType===r.Left)return this.app.scene.nodes.forEach((e=>e.selected=!1)),this.app.scene.refresh(),!1}onContextMenu(e){return e.preventDefault(),e.stopPropagation(),!1}drawMouseSelection(e,t,i,s){this.app.canvas.save().setLineDash([6]).strokeStyle("#fff").lineWidth(2).strokeRect(e,t,i,s).restore()}selectIntersectingControls(e,t){this.app.scene.nodes.forEach((e=>e.selected=!1));this.getIntersectingNodeControls(e,t).forEach((e=>e.selected=!0))}getIntersectingNodeControls(e,t){return this.app.scene.nodes.filter((i=>h.checkIntersection(e,t,i.position,i.size)))||[]}getIntersectingControls(e,t){return this.app.scene.interactables.filter((i=>h.checkIntersection(e,t,i.getAbsolutPosition(),i.size)))||[]}getAbsoluteMousePosition(e){const t=this.app.scene.camera.position,i=this.getMousePosition(e);return new d(i.x-t.x,i.y-t.y)}getAbsoluteMouseDownPosition(e){const t=this.app.scene.camera.position;return new d(this._mouseDownData.position.x-t.x,this._mouseDownData.position.y-t.y)}selectAllNodes(){return this.app.scene.nodes.forEach((e=>e.selected=!0)),this.app.scene.refresh(),!0}getMousePosition(e){let t=this._element.getBoundingClientRect();return new d(e.clientX-t.left,e.clientY-t.top)}}!function(e){e.delegate="delegate",e.exec="exec",e.object="object",e.int="int",e.int64="int64",e.string="string",e.text="text",e.float="float",e.struct="struct",e.class="class",e.bool="bool",e.name="name",e.wildcard="wildcard",e.byte="byte"}(o||(o={})),function(e){e[e.EGPD_Input=0]="EGPD_Input",e[e.EGPD_Output=1]="EGPD_Output"}(l||(l={}));class _{}class m extends _{constructor(e){super(),this.nodeName=e,this.direction=l.EGPD_Input}get isLinked(){return this.linkedTo&&this.linkedTo.length>0}get formattedName(){return this.hideName?"":this.friendlyName?this.friendlyName:this.name}get shouldDrawDefaultValueBox(){return!this.isLinked&&this.direction!==l.EGPD_Output&&null!=this.defaultValue}getUniqueName(){return this.nodeName+" "+this.id}}const f={K2_SetTimerDelegate:"Set Timer by Event",K2_SetTimer:"Set Timer by Function Name",K2_PauseTimer:"Pause Timer by Function Name",K2_ClearAndInvalidateTimerHandle:"Clear and Invalidate Timer by Handle",K2_ClearTimer:"Clear Timer by Function Name",K2_TimerExists:"Does Timer Exist by Function Name",K2_TimerExistsHandle:"Does Timer Exist by Handle",K2_GetTimerElapsedTime:"Get Timer Elapsed Time by Function Name",K2_GetTimerElapsedTimeHandle:"Get Timer Elapsed Time by Handle",K2_InvalidateTimerHandle:"Invalidate",K2_IsTimerActiveHandle:"Is Timer Active by Handle",K2_DestroyActor:"Destroy Actor"};function T(e){return(e=e||"").replace(/((?<=[a-z])[A-Z]+)/g," $1")}function g(e){return f[e]||e}function E(e){return function(e){return(e=e.trim()).charAt(0).toUpperCase()+e.slice(1)}(T(function(e){return e.replace(/^b(?=[A-Z])/g,"")}(e).replace(/[_]/g," ")))}function N(e){let t=Number(e);return isNaN(t)?e:Number.isInteger(t)?t+".0":t.toString()}const C=JSON.parse('{"/Script/Engine.ESpawnActorCollisionHandlingMethod":{"Undefined":"Default","AlwaysSpawn":"Always Spawn, Ignore Collisions","AdjustIfPossibleButAlwaysSpawn":"Try to Adjust Location, But Always Spawn","AdjustIfPossibleButDontSpawnIfColliding":"Try to Adjust Location, Don\'t Spawn If Still Colliding","DontSpawnIfColliding":"Do Not Spawn"},"/Script/Engine.ETraceTypeQuery":{"TraceTypeQuery1":"Visibility","TraceTypeQuery2":"Camera"},"/Script/Engine.ECanBeCharacterBase":{"ECB_Yes":"Yes","ECB_No":"No","ECB_Owner":"(Owner)"},"/Script/Engine.ECollisionChannel":{"ECC_WorldStatic":"WorldStatic","ECC_WorldDynamic":"WorldDynamic","ECC_Pawn":"Pawn","ECC_Visibility":"Visibility","ECC_Camera":"Camera","ECC_PhysicsBody":"PhysicsBody","ECC_Vehicle":"Vehicle","ECC_Destructible":"Destructible"},"/Script/UMG.ESlateVisibility":{"Visible":"Visible","Collapsed":"Collapsed","Hidden":"Hidden","HitTestInvisible":"Not Hit-Testable (Self & All Children)","SelfHitTestInvisible":"Not Hit-Testable (Self Only)"}}');var y,P,O,A,x,S,w,I=n.t(C,2);class D{static parseString(e){return e.replace(/(?<!\\)["']/g,"")}static stripLine(e){return e.replace("\t","").trim()}static parseColor(e){let t=(e=e.replace(/[()]/g,"")).split(","),i=[];for(let e of t){let t=e.split("="),s="A"!=t[0]?Math.floor(255*Number.parseFloat(t[1])):Number.parseFloat(t[1]);i.push(s)}return"rgba("+i.join(",")+")"}static getClassFriendlyName(e){const t=D.parseString(e),i=/(?<=\.)((?!_C$)\w)*/g.exec(t);return i?i[0]:e}static hidePinNames(e){e.forEach((e=>{if(e instanceof m==!1)return!1;e.hideName=!0}))}static configureFirstDelegatePinInHead(e){for(const t of e)if(t instanceof m&&t.direction===l.EGPD_Output&&t.category===o.delegate&&"Output Delegate"===t.name)return t.showInHead=!0,void(t.hideName=!0)}static getFirstClassNameFromPinProperties(e){for(const t of e)if(t instanceof m&&"Class"===t.name&&!t.isLinked)return t.defaultValue||"NONE"}static parseEnumValue(e,t){t=t.replace(/["']/g,"");let i=I[e];if(i){return i[t]||E(t)}return E(t)}}!function(e){e.KNOT="/Script/BlueprintGraph.K2Node_Knot",e.CALL_FUNCTION="/Script/BlueprintGraph.K2Node_CallFunction",e.IF_THEN_ELSE="/Script/BlueprintGraph.K2Node_IfThenElse",e.EXECUTION_SEQUENCE="/Script/BlueprintGraph.K2Node_ExecutionSequence",e.MULTI_GATE="/Script/BlueprintGraph.K2Node_MultiGate",e.VARIABLE_GET="/Script/BlueprintGraph.K2Node_VariableGet",e.VARIABLE_SET="/Script/BlueprintGraph.K2Node_VariableSet",e.EVENT="/Script/BlueprintGraph.K2Node_Event",e.CUSTOM_EVENT="/Script/BlueprintGraph.K2Node_CustomEvent",e.INPUT_AXIS_EVENT="/Script/BlueprintGraph.K2Node_InputAxisEvent",e.COMMENT="/Script/UnrealEd.EdGraphNode_Comment",e.INPUT_KEY="/Script/BlueprintGraph.K2Node_InputKey",e.CommutativeAssociativeBinaryOperator="/Script/BlueprintGraph.K2Node_CommutativeAssociativeBinaryOperator",e.DYNAMIC_CAST="/Script/BlueprintGraph.K2Node_DynamicCast",e.SWITCH_ENUM="/Script/BlueprintGraph.K2Node_SwitchEnum",e.MACRO_INSTANCE="/Script/BlueprintGraph.K2Node_MacroInstance",e.FUNCTION_ENTRY="/Script/BlueprintGraph.K2Node_FunctionEntry",e.FUNCTION_RESULT="/Script/BlueprintGraph.K2Node_FunctionResult",e.CALL_ARRAY_FUNCTION="/Script/BlueprintGraph.K2Node_CallArrayFunction",e.SELF="/Script/BlueprintGraph.K2Node_Self",e.GET_ARRAY_ITEM="/Script/BlueprintGraph.K2Node_GetArrayItem",e.MAKE_ARRAY="/Script/BlueprintGraph.K2Node_MakeArray",e.INPUT_TOUCH="/Script/BlueprintGraph.K2Node_InputTouch",e.GET_INPUT_AXIS_KEY_VALUE="/Script/BlueprintGraph.K2Node_GetInputAxisKeyValue",e.SET_FIELDS_IN_STRUCT="/Script/BlueprintGraph.K2Node_SetFieldsInStruct",e.BREAK_STRUCT="/Script/BlueprintGraph.K2Node_BreakStruct",e.MAKE_STRUCT="/Script/BlueprintGraph.K2Node_MakeStruct",e.SELECT="/Script/BlueprintGraph.K2Node_Select",e.TIMELINE="/Script/BlueprintGraph.K2Node_Timeline",e.SPAWN_ACTOR_FROM_CLASS="/Script/BlueprintGraph.K2Node_SpawnActorFromClass",e.TUNNEL="/Script/BlueprintGraph.K2Node_Tunnel",e.CREATE_WIDGET="/Script/UMGEditor.K2Node_CreateWidget",e.CREATE_OBJECT="/Script/BlueprintGraph.K2Node_GenericCreateObject"}(y||(y={}));class b{}b.NODE_FONT="12px sans-serif",b.NODE_HEADER_FONT="bold 12px sans-serif",b.NODE_BACKGROUND_COLOR="rgba(15,15,15,0.6)",b.NODE_TEXT_COLOR="rgb(240,240,240)",b.NODE_SUBTITLE_COLOR="rgb(170,170,170)",b.NODE_MATHFUNC_TITLE_FONT="bold 24px sans-serif",b.NODE_MATHFUNC_SUBTITLE_FONT="bold 12px sans-serif",b.NODE_MATHFUNC_TITLE_COLOR="rgb(142,142,142)",b.DEFAULT_VALUE_BOX_TEXT_PADDING=4,b.DEFAULT_VALUE_BOX_MARGIN_LEFT=8,b.DEFAULT_FUNC_BACKGROUND_COLOR="78, 117, 142",b.DEFAULT_FUNC_PURE_BACKGROUND_COLOR="92, 154, 87",b.DEFAULT_FUNC_ENTRY_BACKGROUND_COLOR="109, 19, 132",b.DEFAULT_BOX_HEIGHT=16,b.DEFAULT_BOX_RADIUS=2;class R{constructor(e,...t){"string"==typeof e?this.initializeFromString(e):"number"==typeof e&&t.length>=2&&(t.unshift(e),this.initializeFromComponentValues(t))}initializeFromString(e){if(e.startsWith("#"))this.R=Number.parseInt(e.substr(1,2),16),this.G=Number.parseInt(e.substr(3,2),16),this.B=Number.parseInt(e.substr(5,2),16),this.A=1,e.length>=9&&(this.A=Number.parseInt(e.substr(7,2),16));else if(e.startsWith("rgb")){let t=e.startsWith("rgba"),i=(e=e.replace(/[rgba()]/g,"")).split(",");this.R=Number.parseInt(i[0]),this.G=Number.parseInt(i[1]),this.B=Number.parseInt(i[2]),this.A=1,t&&(this.A=Number.parseFloat(i[3]))}}initializeFromComponentValues(e){this.R=e[0],this.G=e[1],this.B=e[2],this.A=1,e.length>3&&(this.A=e[3])}applyGamma(){this.R=Math.floor(255*Math.min(1,Math.max(0,Math.pow(this.R/255,1/2.2)))),this.G=Math.floor(255*Math.min(1,Math.max(0,Math.pow(this.G/255,1/2.2)))),this.B=Math.floor(255*Math.min(1,Math.max(0,Math.pow(this.B/255,1/2.2))))}darken(e){e=1-e,this.R=this.R*e,this.G=this.G*e,this.B=this.B*e}toRGBString(){return"rgb("+[this.R,this.G,this.B].join(",")+")"}toRGBAString(){return"rgba("+[this.R,this.G,this.B,this.A].join(",")+")"}toHexString(){let e="#";return e=("0"+this.R.toString(16)).slice(-2)+("0"+this.G.toString(16)).slice(-2)+("0"+this.B.toString(16)).slice(-2),e}toHexWithAlphaString(){let e="#";return e=("0"+this.R.toString(16)).slice(-2)+("0"+this.G.toString(16)).slice(-2)+("0"+this.B.toString(16)).slice(-2)+("0"+this.A.toString(16)).slice(-2),e}}!function(e){e.None="None",e.Array="Array",e.Set="Set",e.Map="Map"}(P||(P={}));class L{constructor(e,t,i){this.position=new d(e||0,t||0),this.zIndex=i||0}get position(){return this._position}set position(e){this._position=e}initControl(e){this.app=e,this.initialize()}initialize(){}get size(){return new d(this.width,this.height)}get ZIndex(){return this.zIndex}set ZIndex(e){this.zIndex=e}}class M extends L{constructor(e,t,i){super(e,t,i),this.padding={top:0,right:0,bottom:0,left:0},this.controlSize=new d(0,0),this.visible=!0}get parent(){return this.controlParent}set parent(e){this.controlParent=e}draw(e){this.visible&&(e.save(),e.translate(Math.round(this.position.x),Math.round(this.position.y)),this.onDraw(e),e.restore())}refreshLayout(){this.controlSize=this.getCalculatedSize(),this.setDirty(!0),this.controlParent&&this.controlParent.refreshLayout()}getCalculatedSize(){let e=this.size;return e.x+=this.padding.left+this.padding.right,e.y+=this.padding.top+this.padding.bottom,e}get size(){let e=this.controlSize.copy();return e.x=Math.max(e.x,this.desiredWidth||0),e.y=Math.max(e.y,this.desiredHeight||0),e.x=Math.max(e.x,this.minWidth||0),e.y=Math.max(e.y,this.minHeight||0),e.x=this.width?this.width:e.x,e.y=this.height?this.height:e.y,e}setDirty(e){this.dirty=e}isDirty(){return this.dirty}getAbsolutPosition(){let e=new d(0,0);return void 0!==this.controlParent&&(e=this.controlParent.getAbsolutPosition(),e.y+=this.controlParent.padding.top,e.x+=this.controlParent.padding.left),e.x+=this.position.x,e.y+=this.position.y,e}findParent(e){if(void 0!==this.controlParent)return this.controlParent instanceof e?this.controlParent:this.controlParent.findParent(e)}}!function(e){e.VECTOR="/Script/CoreUObject.Vector",e.ROTATOR="/Script/CoreUObject.Rotator",e.LatentActionInfo="/Script/Engine.LatentActionInfo",e.LINEAR_COLOR="/Script/CoreUObject.LinearColor",e.VECTOR2D="/Script/CoreUObject.Vector2D",e.TRANSFORM="/Script/CoreUObject.Transform"}(O||(O={}));class U{static getPinColor(e){return this.getPinColorByCategory(e.category,e.subCategoryObject.class)}static getPinColorByCategory(e,t){switch(e){case o.delegate:return"rgb(255, 56, 56)";case o.bool:return"rgb(146, 1, 1)";case o.float:return"rgb(158, 250, 68)";case o.int:return"rgb(30, 226, 174)";case o.int64:return"rgb(171, 226, 174)";case o.byte:return"rgb(0, 101, 92)";case o.struct:return{[O.VECTOR]:"rgb(253, 200, 35)",[O.ROTATOR]:"rgb(159, 178, 253)",[O.TRANSFORM]:"rgb(230, 105, 2)"}[t]||"rgb(0, 88, 200)";case o.name:return"rgb(150, 97, 185)";case o.string:return"rgb(254, 0, 212)";case o.object:return"rgb(0, 133, 191)";case o.class:return"rgb(88, 0, 187)";case o.wildcard:return"rgb(128, 121, 121)";case o.text:return"rgb(230, 123, 169)";case o.byte:return"rgb(0, 110, 100)";default:return"rgb(230, 230, 230)"}}}class F{}F.PIN_ARRAY_CONNECTED="M9.482,10.473l-2.964,-0l0,3.024l2.964,0l-0,-3.024Zm-3.969,-0l-2.963,-0l-0,3.024l2.963,0l0,-3.024Zm7.937,-0l-2.963,-0l-0,3.024l2.963,0l0,-3.024Zm-3.968,-4.027l-2.964,0l0,3.025l2.964,-0l-0,-3.025Zm-3.969,0l-2.963,0l-0,3.025l2.963,-0l0,-3.025Zm7.937,0l-2.963,0l-0,3.025l2.963,-0l0,-3.025Zm-7.937,-4.026l-2.963,-0l-0,3.024l2.963,0l0,-3.024Zm3.969,-0l-2.964,-0l0,3.024l2.964,0l-0,-3.024Zm3.968,-0l-2.963,-0l-0,3.024l2.963,0l0,-3.024Z",F.PIN_ARRAY_DISCONNECTED="M9.482,10.473l-2.964,-0l0,3.024l2.964,0l-0,-3.024Zm-3.969,-0l-2.963,-0l-0,3.024l2.963,0l0,-3.024Zm7.937,-0l-2.963,-0l-0,3.024l2.963,0l0,-3.024Zm-7.937,-4.027l-2.963,0l-0,3.025l2.963,-0l0,-3.025Zm7.937,0l-2.963,0l-0,3.025l2.963,-0l0,-3.025Zm-7.937,-4.026l-2.963,-0l-0,3.024l2.963,0l0,-3.024Zm3.969,-0l-2.964,-0l0,3.024l2.964,0l-0,-3.024Zm3.968,-0l-2.963,-0l-0,3.024l2.963,0l0,-3.024Z",F.PIN_SET="M6.966,1.985l-0,2.034l-1.053,-0c-0.494,-0 -0.894,0.4 -0.894,0.894l-0,0.07l-0.013,-0c-0,1.187 -0.516,2.255 -1.336,2.992c0.82,0.736 1.336,1.804 1.336,2.992l-0.002,0.05l0.015,0l-0,0.07c-0,0.494 0.4,0.894 0.894,0.894l1.053,0l-0,1.999l-1.469,-0c-1.382,-0 -2.504,-1.122 -2.504,-2.503l0,-0.46c0,-1.11 -0.901,-2.011 -2.011,-2.011l0,-2.012c1.11,-0 2.011,-0.901 2.011,-2.011l0,-0.495c0,-1.381 1.122,-2.503 2.504,-2.503l1.469,0Zm2.002,0l1.535,0c1.382,0 2.504,1.122 2.504,2.503l-0,0.495c-0,1.11 0.901,2.011 2.011,2.011l-0,2.012c-1.11,0 -2.011,0.901 -2.011,2.011l-0,0.46c-0,1.381 -1.122,2.503 -2.504,2.503l-1.535,-0l0,-1.999l1.119,0c0.494,0 0.894,-0.4 0.894,-0.894l0,-0.07l0.013,0c0,-1.194 0.522,-2.268 1.351,-3.005c-0.829,-0.737 -1.351,-1.811 -1.351,-3.006l0.001,-0.023l-0.014,-0l0,-0.07c0,-0.494 -0.4,-0.894 -0.894,-0.894l-1.119,-0l0,-2.034Z",F.PIN_MAP_KEY="M5.513,10.473l-2.963,-0l-0,3.024l2.963,0l0,-3.024Zm0,-4.027l-2.963,0l-0,3.025l2.963,-0l0,-3.025Zm0,-4.026l-2.963,-0l-0,3.024l2.963,0l0,-3.024Z",F.PIN_MAP_VALUE="M13.45,10.473l-6.932,-0l0,3.024l6.932,0l0,-3.024Zm0,-4.027l-6.932,0l0,3.025l6.932,-0l0,-3.025Zm0,-4.026l-6.932,-0l0,3.024l6.932,0l0,-3.024Z",F.PIN_REFERENCE_CONNECTED="M13.45,8.001l-5.45,-5.451l-5.45,5.451l5.45,5.45l5.45,-5.45Z",F.PIN_REFERENCE_DISCONNECTED="M13.45,8.001l-5.45,-5.451l-5.45,5.451l5.45,5.45l5.45,-5.45Zm-2.596,-0l-2.854,-2.855l-2.854,2.855l2.854,2.854l2.854,-2.854Z",F.DEFAULT_VALUE_BOOL_TRUE="M6.42,8.655l-1.177,-1.177c-0.382,-0.382 -1.002,-0.382 -1.383,-0c-0.382,0.381 -0.382,1.001 -0,1.383l1.853,1.853c0.195,0.194 0.451,0.29 0.707,0.285c0.256,0.005 0.513,-0.091 0.707,-0.285l5.013,-5.013c0.382,-0.382 0.382,-1.002 0,-1.383c-0.381,-0.382 -1.001,-0.382 -1.383,-0l-4.337,4.337Z",F.FUNCTION="M12.962,3.932c0.88,-1.811 -0.139,-2.954 -1.879,-2.949c-3.498,0.01 -3.564,2.488 -4.093,5.112l-1.868,-0.077l-0.287,1.435l1.907,0.114l-0.837,5.243c0,-0 -0.292,1.924 -1.164,1.805c-0.978,-0.133 -0.602,-1.396 -0.602,-1.396l-1.174,-0.429c-0.553,1.226 -0.293,3.209 1.87,3.21c3.352,0.001 3.163,-1.918 4.352,-8.227l1.697,0.093l0.435,-1.485l-1.849,-0.089c0.501,-2.285 0.48,-4.128 1.849,-3.868c0.618,0.118 0.249,1.508 0.249,1.508l1.394,-0Z",F.MAKE_STRUCT="M1.121,16l-1.121,-1.121l2.332,-2.332l-1.778,-0l-0,-1.586l4.485,-0l0,4.485l-1.586,0l0,-1.778l-2.332,2.332Zm12.316,-9.213c0,-0.606 -0.492,-1.098 -1.097,-1.098l-7.824,0c-0.606,0 -1.098,0.492 -1.098,1.098l-0,2.196c-0,0.606 0.492,1.098 1.098,1.098l7.824,-0c0.605,-0 1.097,-0.492 1.097,-1.098l0,-2.196Zm-13.437,-5.666l1.121,-1.121l2.332,2.332l0,-1.778l1.586,-0l0,4.485l-4.485,0l-0,-1.586l1.778,0l-2.332,-2.332Z",F.BREAK_STRUCT="M11.011,12.082l1.122,-1.121l2.332,2.332l-0,-1.778l1.585,-0l0,4.485l-4.485,-0l0,-1.586l1.778,0l-2.332,-2.332Zm2.426,-5.237c0,-0.606 -0.492,-1.098 -1.097,-1.098l-7.824,-0c-0.606,-0 -1.098,0.492 -1.098,1.098l-0,2.195c-0,0.606 0.492,1.098 1.098,1.098l7.824,0c0.605,0 1.097,-0.492 1.097,-1.098l0,-2.195Zm-1.358,-1.803l-1.121,-1.121l2.332,-2.332l-1.779,0l0,-1.586l4.486,0l-0,4.486l-1.586,-0l-0,-1.779l-2.332,2.332Z",F.EVENT="M15.475,9.212c0.669,-0.669 0.669,-1.755 -0,-2.424l-6.263,-6.263c-0.669,-0.669 -1.755,-0.669 -2.424,0l-6.263,6.263c-0.669,0.669 -0.669,1.755 0,2.424l6.263,6.263c0.669,0.669 1.755,0.669 2.424,-0l6.263,-6.263Zm-11.195,1.194c-0.116,-0 -0.227,-0.046 -0.309,-0.128c-0.082,-0.082 -0.128,-0.193 -0.128,-0.309c0,-0.923 0,-3.057 0,-3.947c0,-0.106 0.042,-0.207 0.117,-0.282c0.075,-0.075 0.177,-0.118 0.283,-0.118c0.95,0 3.261,0 3.261,0l0,-3.552c0,-0.151 0.09,-0.287 0.228,-0.348c0.138,-0.06 0.298,-0.033 0.409,0.069c1.527,1.411 5.35,4.945 6.44,5.951c0.076,0.071 0.119,0.169 0.119,0.272c-0,0.103 -0.043,0.202 -0.119,0.272c-1.081,0.999 -4.856,4.487 -6.405,5.919c-0.117,0.108 -0.286,0.136 -0.432,0.073c-0.146,-0.064 -0.24,-0.208 -0.24,-0.367c0,-1.294 0,-3.505 0,-3.505l-3.224,-0Z",F.CUSTOM_EVENT="M15.475,9.212c0.669,-0.669 0.669,-1.755 -0,-2.424l-6.263,-6.263c-0.669,-0.669 -1.755,-0.669 -2.424,0l-6.263,6.263c-0.669,0.669 -0.669,1.755 0,2.424l6.263,6.263c0.669,0.669 1.755,0.669 2.424,-0l6.263,-6.263Zm-11.195,1.194c-0.116,-0 -0.227,-0.046 -0.309,-0.128c-0.082,-0.082 -0.128,-0.193 -0.128,-0.309c0,-0.923 0,-3.057 0,-3.947c0,-0.106 0.042,-0.207 0.117,-0.282c0.075,-0.075 0.177,-0.118 0.283,-0.118c0.95,0 3.261,0 3.261,0l0,-3.552c0,-0.151 0.09,-0.287 0.228,-0.348c0.138,-0.06 0.298,-0.033 0.409,0.069c1.527,1.411 5.35,4.945 6.44,5.951c0.076,0.071 0.119,0.169 0.119,0.272c-0,0.103 -0.043,0.202 -0.119,0.272c-1.081,0.999 -4.856,4.487 -6.405,5.919c-0.117,0.108 -0.286,0.136 -0.432,0.073c-0.146,-0.064 -0.24,-0.208 -0.24,-0.367c0,-1.294 0,-3.505 0,-3.505l-3.224,-0Zm6.96,-4.087c-0.446,-0.446 -1.051,-0.697 -1.682,-0.697c-1.313,0 -2.378,1.066 -2.378,2.379c-0,1.313 1.065,2.378 2.378,2.378c0.631,0 1.236,-0.25 1.682,-0.696l-0.841,-0.841c-0.223,0.223 -0.526,0.348 -0.841,0.348c-0.656,0 -1.189,-0.533 -1.189,-1.189c-0,-0.656 0.533,-1.189 1.189,-1.189c0.315,-0 0.618,0.125 0.841,0.348l0.841,-0.841Z",F.BRANCH="M10.996,1.917l0,-1.917l3.956,2.482l-3.956,2.482l0,-1.818l-1.257,0l-0.125,0.002c-2.623,0.066 -4.729,2.213 -4.729,4.852c0,2.681 2.173,4.854 4.854,4.854l1.257,-0l0,-1.818l3.956,2.482l-3.956,2.482l0,-1.917l-1.257,0c-3.022,0 -5.529,-2.202 -6.002,-5.089l-2.755,-0l0,-1.988l2.755,0c0.473,-2.887 2.98,-5.089 6.002,-5.089l1.257,-0Z",F.SEQUENCE="M4.975,11.974l-0,-3.015l3.025,-0l0,-1.988l-3.025,-0l-0,-3.015l3.025,-0l0,-1.989l-5.014,0l0,5.039l-3.025,-0l0,1.988l3.025,0l0,4.968l5.014,0l-0,-1.988l-3.025,-0Zm4.36,-0l-0,1.988l2.018,0l-0,-1.988l-2.018,-0Zm-0,-5.003l-0,1.988l4.036,-0l-0,-1.988l-4.036,-0Zm-0,-5.004l-0,1.989l5.617,-0l-0,-1.989l-5.617,0Z",F.LOOP="M5.952,2.997l0,-2.041l4.857,3.472l-4.857,3.473l0,-2.428c-1.902,0.046 -3.433,1.606 -3.433,3.52c0,1.944 1.579,3.522 3.522,3.522l3.918,-0c1.943,-0 3.522,-1.578 3.522,-3.522c-0,-1.651 -1.138,-3.037 -2.672,-3.418l0,-2.524c2.929,0.393 5.191,2.905 5.191,5.942c0,3.31 -2.687,5.997 -5.997,5.997l-4.006,0c-3.31,0 -5.997,-2.687 -5.997,-5.997c0,-3.295 2.663,-5.973 5.952,-5.996Z",F.GATE="M0.982,2.984l0,10.004l13.97,-0l-0,-10.004l-13.97,0Zm11.496,8.493l-4.538,-2.756l-5.424,-0l-0,2.756l9.962,-0Zm-2.065,-2.756l3.005,1.824l0,-1.824l-3.005,-0Zm-7.897,-1.502l2.951,-0l-2.951,-1.792l-0,1.792Zm0.939,-2.724l4.485,2.724l5.478,-0l0,-2.724l-9.963,0Z",F.FLIPFLOP="M10.251,14.01l4.701,-10.034l-0,-2.993l-4.701,10.034l-3.977,-10.034l-5.292,10.034l0,2.993l5.292,-10.034l3.977,10.034Z",F.DO_N="M0.982,10.143l0,-2.242l10.492,0l-0.903,-0.902l1.179,-1.179l3.202,3.202l-3.202,3.202l-1.179,-1.178l0.903,-0.903l-10.492,-0Zm6.017,-7.805l1.981,2.627l1.023,-0l-0,-3.982l-1.023,-0l0,2.627l-1.981,-2.627l-1.022,-0l-0,3.982l1.022,-0l-0,-2.627Z",F.DO_ONCE="M0.982,10.143l0,-2.242l10.492,0l-0.903,-0.902l1.179,-1.179l3.202,3.202l-3.202,3.202l-1.179,-1.178l0.903,-0.903l-10.492,-0Zm6.045,-9.16l0.973,-0l0,4.005l0.988,0l0,1.002l-2.983,-0l0,-1.002l1.002,0l-0,-2.002l-1.002,-0l0,-0.981c0.564,-0 1.022,-0.458 1.022,-1.022Z",F.SWITCH="M4.975,11.974l-0,-3.015l3.025,-0l0,-1.988l-3.025,-0l-0,-3.015l3.025,-0l0,-1.989l-5.014,0l0,5.039l-3.025,-0l0,1.988l3.025,0l0,4.968l5.014,0l-0,-1.988l-3.025,-0Zm4.983,-7.935l0,-2.094l2.817,-0l-0.875,-0.875l1.069,-1.07l2.992,2.992l-2.992,2.991l-1.069,-1.069l0.875,-0.875l-2.817,-0Z",F.CAST="M5.22,9.035l-3.249,2.233l0,-5.509l3.261,2.241l4.768,0l-0,-3.001l4.952,3.515l-4.952,3.515l-0,-2.994l-4.78,0Z",F.SELECT="M8,6.971l0,-5.004l-6.005,0l0,1.989l4.017,-0l-0,3.015l-4.017,-0l0,1.988l4.017,-0l-0,3.015l-4.017,-0l0,1.988l4.017,0l-0,0.035l1.988,0l0,-5.038l1.017,-0l-0,-1.988l-1.017,-0Zm3.966,2.074l-1.956,-0l0,-2.09l1.956,0l0,-1.941l1.048,0l2.986,2.986l-2.986,2.986l-1.048,-0l0,-1.941Z",F.INPUT_KEY="M9.263,12.728c-0,-0.247 -0.201,-0.447 -0.447,-0.447l-2.566,-0c-0.247,-0 -0.447,0.2 -0.447,0.447l0,2.619c0,0.247 0.2,0.447 0.447,0.447l2.566,0c0.246,0 0.447,-0.2 0.447,-0.447l-0,-2.619Zm3.923,-0c-0,-0.247 -0.2,-0.447 -0.447,-0.447l-2.566,-0c-0.246,-0 -0.447,0.2 -0.447,0.447l0,2.619c0,0.247 0.201,0.447 0.447,0.447l2.566,0c0.247,0 0.447,-0.2 0.447,-0.447l-0,-2.619Zm-5.429,-4.005c-0,-0.247 -0.201,-0.447 -0.447,-0.447l-2.566,-0c-0.246,-0 -0.447,0.2 -0.447,0.447l0,2.619c0,0.247 0.201,0.447 0.447,0.447l2.566,-0c0.246,-0 0.447,-0.2 0.447,-0.447l-0,-2.619Zm7.892,-0c-0,-0.247 -0.201,-0.447 -0.448,-0.447l-2.565,-0c-0.247,-0 -0.447,0.2 -0.447,0.447l0,2.619c0,0.247 0.2,0.447 0.447,0.447l2.565,-0c0.247,-0 0.448,-0.2 0.448,-0.447l-0,-2.619Zm-11.838,-0c-0,-0.247 -0.2,-0.447 -0.447,-0.447l-2.565,-0c-0.247,-0 -0.448,0.2 -0.448,0.447l0,2.619c0,0.247 0.201,0.447 0.448,0.447l2.565,-0c0.247,-0 0.447,-0.2 0.447,-0.447l-0,-2.619Zm7.892,-0c-0,-0.247 -0.201,-0.447 -0.447,-0.447l-2.566,-0c-0.246,-0 -0.447,0.2 -0.447,0.447l0,2.619c0,0.247 0.201,0.447 0.447,0.447l2.566,-0c0.246,-0 0.447,-0.2 0.447,-0.447l-0,-2.619Zm-4.918,-4.005c0,-0.247 -0.2,-0.448 -0.447,-0.448l-2.565,0c-0.247,0 -0.447,0.201 -0.447,0.448l-0,2.619c-0,0.246 0.2,0.447 0.447,0.447l2.565,-0c0.247,-0 0.447,-0.201 0.447,-0.447l0,-2.619Zm3.938,-0c0,-0.247 -0.2,-0.448 -0.447,-0.448l-2.565,0c-0.247,0 -0.447,0.201 -0.447,0.448l-0,2.619c-0,0.246 0.2,0.447 0.447,0.447l2.565,-0c0.247,-0 0.447,-0.201 0.447,-0.447l0,-2.619Zm-2.966,-4.065c-0,-0.247 -0.201,-0.447 -0.447,-0.447l-2.566,-0c-0.246,-0 -0.447,0.2 -0.447,0.447l0,2.619c0,0.247 0.201,0.447 0.447,0.447l2.566,0c0.246,0 0.447,-0.2 0.447,-0.447l-0,-2.619Zm-3.946,0c-0,-0.247 -0.2,-0.447 -0.447,-0.447l-2.565,-0c-0.247,-0 -0.448,0.2 -0.448,0.447l0,2.619c0,0.247 0.201,0.447 0.448,0.447l2.565,0c0.247,0 0.447,-0.2 0.447,-0.447l-0,-2.619Zm7.892,0c-0,-0.247 -0.201,-0.447 -0.447,-0.447l-2.566,-0c-0.246,-0 -0.447,0.2 -0.447,0.447l0,2.619c0,0.247 0.201,0.447 0.447,0.447l2.566,0c0.246,0 0.447,-0.2 0.447,-0.447l-0,-2.619Z",F.INPUT_GAMEPAD="M10.506,5.016l0,-0.246c0,-0.135 0.111,-0.245 0.246,-0.245l1.507,-0c0.136,-0 0.246,0.11 0.246,0.245l-0,0.701c0.632,0.356 1.144,0.99 1.498,1.729c0.619,1.289 1.706,5.78 -0.433,5.81c-1.305,0.018 -1.934,-1.533 -3.13,-3.351l-4.88,-0c-1.196,1.818 -1.825,3.369 -3.13,3.351c-2.139,-0.03 -1.052,-4.521 -0.433,-5.81c0.354,-0.739 0.866,-1.373 1.498,-1.729l0,-0.701c0,-0.135 0.11,-0.245 0.246,-0.245l1.507,-0c0.135,-0 0.246,0.11 0.246,0.245l-0,0.246l5.012,-0Zm0.788,2.477c-0.251,0 -0.439,0.198 -0.42,0.442c0.019,0.244 0.238,0.442 0.489,0.442c0.251,0 0.439,-0.198 0.42,-0.442c-0.019,-0.244 -0.238,-0.442 -0.489,-0.442Zm-6.834,0c0.251,0 0.439,0.198 0.42,0.442c-0.019,0.244 -0.238,0.442 -0.489,0.442c-0.251,0 -0.439,-0.198 -0.42,-0.442c0.019,-0.244 0.238,-0.442 0.489,-0.442Zm7.555,-0.735c-0.251,0 -0.44,0.198 -0.421,0.442c0.019,0.244 0.238,0.442 0.489,0.442c0.251,0 0.44,-0.198 0.421,-0.442c-0.019,-0.244 -0.238,-0.442 -0.489,-0.442Zm-1.633,0c-0.251,0 -0.439,0.198 -0.42,0.442c0.019,0.244 0.238,0.442 0.489,0.442c0.251,0 0.439,-0.198 0.42,-0.442c-0.019,-0.244 -0.238,-0.442 -0.489,-0.442Zm-6.643,0c0.251,0 0.439,0.198 0.42,0.442c-0.019,0.244 -0.238,0.442 -0.489,0.442c-0.251,0 -0.439,-0.198 -0.42,-0.442c0.019,-0.244 0.238,-0.442 0.489,-0.442Zm1.633,0c0.25,0 0.439,0.198 0.42,0.442c-0.019,0.244 -0.238,0.442 -0.489,0.442c-0.251,0 -0.439,-0.198 -0.42,-0.442c0.019,-0.244 0.238,-0.442 0.489,-0.442Zm5.731,-0.71c-0.251,0 -0.439,0.198 -0.42,0.442c0.019,0.244 0.238,0.442 0.489,0.442c0.25,0 0.439,-0.198 0.42,-0.442c-0.019,-0.244 -0.238,-0.442 -0.489,-0.442Zm-6.452,0c0.251,0 0.439,0.198 0.42,0.442c-0.019,0.244 -0.238,0.442 -0.489,0.442c-0.251,0 -0.439,-0.198 -0.42,-0.442c0.019,-0.244 0.238,-0.442 0.489,-0.442Z",F.INPUT_TOUCH="M7.717,11.585c-0,-0.332 -0.27,-0.601 -0.601,-0.601l-5.533,-0c-0.332,-0 -0.601,0.269 -0.601,0.601l0,2.804c0,0.332 0.269,0.601 0.601,0.601l5.533,0c0.331,0 0.601,-0.269 0.601,-0.601l-0,-2.804Zm7.301,-0c-0,-0.332 -0.269,-0.601 -0.601,-0.601l-5.533,-0c-0.331,-0 -0.601,0.269 -0.601,0.601l0,2.804c0,0.332 0.27,0.601 0.601,0.601l5.533,0c0.332,0 0.601,-0.269 0.601,-0.601l-0,-2.804Zm-0,-10.128c-0,-0.262 -0.212,-0.474 -0.474,-0.474l-13.088,-0c-0.262,-0 -0.474,0.212 -0.474,0.474l0,8.531c0,0.262 0.212,0.474 0.474,0.474l13.088,0c0.262,0 0.474,-0.212 0.474,-0.474l-0,-8.531Zm-7.018,0.527c2.063,0 3.738,1.675 3.738,3.738c0,2.064 -1.675,3.739 -3.738,3.739c-2.063,-0 -3.738,-1.675 -3.738,-3.739c-0,-2.063 1.675,-3.738 3.738,-3.738Zm0,0.603c1.73,-0 3.135,1.405 3.135,3.135c0,1.731 -1.405,3.136 -3.135,3.136c-1.73,-0 -3.135,-1.405 -3.135,-3.136c-0,-1.73 1.405,-3.135 3.135,-3.135Z",F.MOUSE="M2.706,6.758c1.309,-0.436 3.204,-0.718 5.294,-0.718c1.872,-0 3.587,0.227 4.865,0.587c0.006,0.446 0.006,0.905 0.006,1.373c-0,4.415 -2.719,8 -4.881,8c-2.162,0 -5.299,-3.585 -5.299,-8c0,-0.423 0.004,-0.838 0.015,-1.242Zm5.02,-6.755l0,1.879c-0.49,0.309 -0.854,1.062 -0.854,1.93c-0,0.669 0.216,1.268 0.538,1.65c-1.863,0.052 -3.52,0.347 -4.685,0.791c0.16,-3.503 1.016,-6.148 5.001,-6.25Zm0.527,0.001c3.916,0.117 4.511,2.677 4.602,6.102c-1.133,-0.363 -2.629,-0.6 -4.285,-0.645c0.322,-0.381 0.537,-0.981 0.537,-1.649c0,-0.868 -0.364,-1.621 -0.854,-1.93l-0,-1.878Zm-0.511,2.184l0.495,0c0.195,0.43 0.33,1.005 0.33,1.624c0,0.628 -0.139,1.212 -0.339,1.643c-0.076,-0.001 -0.152,-0.001 -0.228,-0.001c-0.083,-0 -0.166,0 -0.249,0.001c-0.2,-0.431 -0.339,-1.015 -0.339,-1.643c-0,-0.619 0.135,-1.194 0.33,-1.624Z",F.PILL="M15.018,8.973c-0,-1.637 -1.329,-2.966 -2.966,-2.966l-8.104,-0c-1.637,-0 -2.966,1.329 -2.966,2.966c0,1.637 1.329,2.966 2.966,2.966l8.104,0c1.637,0 2.966,-1.329 2.966,-2.966Z",F.CONSTRUCT="M14.496,5.478c-0.086,0.02 -0.176,0.03 -0.268,0.03l-12.456,-0c-0.092,-0 -0.182,-0.01 -0.268,-0.03l-0,7.663c-0,0.463 0.376,0.839 0.839,0.839l11.314,-0c0.463,-0 0.839,-0.376 0.839,-0.839l0,-7.663Zm0.522,-3.484c-0,-0.558 -0.453,-1.011 -1.012,-1.011l-12.012,-0c-0.559,-0 -1.012,0.453 -1.012,1.011l0,2.024c0,0.558 0.453,1.011 1.012,1.011l12.012,0c0.559,0 1.012,-0.453 1.012,-1.011l-0,-2.024Z",F.TIMER="M8,0.983c3.873,-0 7.018,3.138 7.018,7.004c-0,3.865 -3.145,7.003 -7.018,7.003c-3.873,0 -7.018,-3.138 -7.018,-7.003c0,-3.866 3.145,-7.004 7.018,-7.004Zm0,1.532c3.026,0 5.483,2.452 5.483,5.472c-0,3.019 -2.457,5.471 -5.483,5.471c-3.026,0 -5.483,-2.452 -5.483,-5.471c0,-3.02 2.457,-5.472 5.483,-5.472Zm-0.768,5.099l-0.001,0.012l0,0.748c0,0.206 0.168,0.374 0.374,0.374l4.464,0c0.206,0 0.374,-0.168 0.374,-0.374l-0,-0.748c-0,-0.206 -0.168,-0.374 -0.374,-0.374l-3.3,-0l-0,-2.693c-0,-0.212 -0.173,-0.384 -0.385,-0.384l-0.768,-0c-0.212,-0 -0.385,0.172 -0.385,0.384l0,3.043l0.001,0.012Z",F.MAKE_ARRAY="M0.893,16l-0.893,-0.893l1.857,-1.856l-1.416,-0l-0,-1.263l3.571,0l-0,3.571l-1.263,0l0,-1.416l-1.856,1.857Zm11.086,-5.497l-3.003,0l-0,3.012l3.003,-0l-0,-3.012Zm-4.022,0l-3.003,0l0,3.012l3.003,-0l0,-3.012Zm8.043,0l-3.003,0l-0,3.012l3.003,-0l0,-3.012Zm-4.021,-4.009l-3.003,0l-0,3.012l3.003,-0l-0,-3.012Zm-4.022,0l-3.003,0l0,3.012l3.003,-0l0,-3.012Zm8.043,0l-3.003,0l-0,3.012l3.003,-0l-0,-3.012Zm-8.043,-4.009l-3.003,0l0,3.012l3.003,-0l0,-3.012Zm4.022,0l-3.003,0l-0,3.012l3.003,-0l-0,-3.012Zm4.021,0l-3.003,0l-0,3.012l3.003,-0l-0,-3.012Zm-16,-1.599l0.886,-0.886l1.843,1.843l0,-1.405l1.254,-0l-0,3.545l-3.545,-0l-0,-1.254l1.405,0l-1.843,-1.843Z",F.SPAWN_ACTOR="M7.612,0.994c-0.329,0.393 -0.306,0.98 0.064,1.35l1.26,1.259l-1.686,0c-0.561,0 -1.016,0.456 -1.016,1.017c-0,0.561 0.455,1.017 1.016,1.017l1.684,-0l-1.258,1.258c-0.395,0.395 -0.395,1.035 -0,1.43c0.394,0.394 1.035,0.394 1.429,-0l1.259,-1.259l-0,1.777c-0,0.561 0.455,1.016 1.017,1.016c0.561,0 1.016,-0.455 1.016,-1.016l0,-1.778l1.26,1.26c0.37,0.369 0.955,0.392 1.349,0.065c-0.209,3.678 -3.268,6.6 -7.006,6.6c-3.873,0 -7.018,-3.138 -7.018,-7.003c0,-3.736 2.937,-6.793 6.63,-6.993Zm3.292,7.771c0,0.263 0.214,0.476 0.477,0.476c0.262,0 0.476,-0.213 0.476,-0.476l-0,-2.034c-0,-0.262 -0.214,-0.476 -0.476,-0.476c-0.263,0 -0.477,0.214 -0.477,0.476l0,2.034Zm3.071,-0.877c0.185,0.185 0.487,0.185 0.673,-0c0.186,-0.186 0.186,-0.488 -0,-0.674l-1.438,-1.438c-0.186,-0.186 -0.488,-0.186 -0.673,0c-0.186,0.186 -0.186,0.488 -0,0.674l1.438,1.438Zm-3.751,-1.438c0.186,-0.186 0.186,-0.488 0,-0.674c-0.185,-0.186 -0.487,-0.186 -0.673,0l-1.438,1.438c-0.186,0.186 -0.186,0.488 0,0.674c0.186,0.185 0.488,0.185 0.674,-0l1.437,-1.438Zm4.387,-0.813c0.125,0.346 0.222,0.705 0.289,1.074l-1.075,-1.074l0.786,-0Zm-3.23,-2.034c0.561,0 1.016,0.456 1.016,1.017c0,0.561 -0.455,1.017 -1.016,1.017c-0.562,-0 -1.017,-0.456 -1.017,-1.017c-0,-0.561 0.455,-1.017 1.017,-1.017Zm4.144,1.493c0.263,0 0.476,-0.213 0.476,-0.476c0,-0.263 -0.213,-0.476 -0.476,-0.476l-2.033,0c-0.263,0 -0.476,0.213 -0.476,0.476c-0,0.263 0.213,0.476 0.476,0.476l2.033,0Zm-6.256,0c0.263,0 0.477,-0.213 0.477,-0.476c-0,-0.263 -0.214,-0.476 -0.477,-0.476l-2.033,0c-0.263,0 -0.476,0.213 -0.476,0.476c-0,0.263 0.213,0.476 0.476,0.476l2.033,0Zm0.282,-1.632c0.186,0.186 0.488,0.186 0.673,0c0.186,-0.186 0.186,-0.488 0,-0.673l-1.437,-1.438c-0.186,-0.186 -0.488,-0.186 -0.674,-0c-0.186,0.186 -0.186,0.487 0,0.673l1.438,1.438Zm5.097,-1.438c0.186,-0.186 0.186,-0.487 -0,-0.673c-0.186,-0.186 -0.488,-0.186 -0.673,-0l-1.438,1.438c-0.186,0.185 -0.186,0.487 -0,0.673c0.185,0.186 0.487,0.186 0.673,0l1.438,-1.438Zm-3.744,0.483c0,0.263 0.214,0.476 0.477,0.476c0.262,0 0.476,-0.213 0.476,-0.476l-0,-2.033c-0,-0.263 -0.214,-0.477 -0.476,-0.477c-0.263,0 -0.477,0.214 -0.477,0.477l0,2.033Zm-1.612,-1.406c0.368,0.069 0.726,0.166 1.072,0.289l-0,0.783l-1.072,-1.072Z",F.IS_VALID="M8.968,11.978l-1.982,0l-0,1.982l1.982,0l-0,-1.982Zm-0.968,-4.015l-1.014,0l-0,3.012l1.982,-0l-0,-1.136c1.739,-0.432 3.028,-2.004 3.028,-3.877c0,-2.206 -1.79,-3.996 -3.996,-3.996c-2.207,-0 -3.996,1.789 -3.996,3.996l1.998,-0c-0,-1.104 0.894,-1.998 1.998,-1.998c1.103,-0 1.998,0.895 1.998,1.998c0,1.103 -0.894,1.998 -1.998,1.998l0,0.003Z",F.MACRO="M4.632,6.37c-0.24,0.492 -0.374,1.046 -0.374,1.63c-0,2.065 1.677,3.742 3.742,3.742c2.065,0 3.742,-1.677 3.742,-3.742c0,-2.065 -1.677,-3.742 -3.742,-3.742c-0.418,-0 -0.82,0.069 -1.194,0.196l-0.764,-2.266l0.397,-2.034c1.031,-0.205 2.091,-0.205 3.122,-0l0.409,2.099c0.24,0.082 0.473,0.179 0.701,0.29l1.774,-1.195c0.873,0.584 1.623,1.334 2.207,2.207l-1.195,1.774c0.111,0.228 0.208,0.461 0.29,0.701l2.099,0.409c0.205,1.031 0.205,2.091 0,3.122l-2.099,0.409c-0.082,0.24 -0.179,0.473 -0.29,0.701l1.195,1.774c-0.584,0.873 -1.334,1.623 -2.207,2.207l-1.774,-1.195c-0.228,0.111 -0.461,0.208 -0.701,0.29l-0.409,2.099c-1.031,0.205 -2.091,0.205 -3.122,0l-0.409,-2.099c-0.24,-0.082 -0.473,-0.179 -0.701,-0.29l-1.774,1.195c-0.873,-0.584 -1.623,-1.334 -2.207,-2.207l1.195,-1.774c-0.111,-0.228 -0.208,-0.461 -0.29,-0.701l-2.099,-0.409c-0.205,-1.031 -0.205,-2.091 -0,-3.122l2.099,-0.409c0.077,-0.226 0.167,-0.446 0.272,-0.66l-0.001,-0.001l0.41,-0.846l-1.428,0.353l-0.433,-1.751l4.358,-1.076l1.853,4.087l-1.643,0.745l-0.607,-1.34l-0.402,0.829Z",F.LATENT="M10.667,1.31c5.164,0 9.357,4.185 9.357,9.339c-0,5.154 -4.193,9.338 -9.357,9.338c-5.165,0 -9.358,-4.184 -9.358,-9.338c0,-5.154 4.193,-9.339 9.358,-9.339Zm0.695,8.661l0,-7.105c0,-0.191 -0.156,-0.347 -0.348,-0.347l-0.695,-0c-0.192,-0 -0.348,0.156 -0.348,0.347l0,7.435l0.001,0.009l-0.001,0.009l0,0.695c0,0.192 0.156,0.348 0.348,0.348l5.924,0c0.191,0 0.347,-0.156 0.347,-0.348l0,-0.695c0,-0.192 -0.156,-0.348 -0.347,-0.348l-4.881,0Z";class v extends M{constructor(e,t){super(0,0),this.connections=[],this._pinProperty=t,this.hidden=!1,this._isInput=this._pinProperty.direction!==l.EGPD_Output,this._color=U.getPinColor(this._pinProperty),this._pinProperty.valueType&&(this._secondaryColor=U.getPinColorByCategory(this._pinProperty.valueType)),this.width=0,this.height=27,this.visible=!t.hidden,this.category=t.category,this.initPinIcons()}initialize(){this.visible&&(this.pinProperty.hidden||this.pinProperty.hideName?this.pinProperty.hidden||(this.width=v.PINS_PADDING_HORIZONTAL+v.PIN_ICON_WIDTH):this.width=this.formattedNameWidth(this.pinProperty)+v.PINS_PADDING_HORIZONTAL+v.PIN_ICON_WIDTH),this.postInit()}initPinIcons(){switch(this._pinProperty.containerType){case P.Array:this.icon=this._pinProperty.isLinked?new Path2D(F.PIN_ARRAY_CONNECTED):new Path2D(F.PIN_ARRAY_DISCONNECTED);break;case P.Set:this.icon=new Path2D(F.PIN_SET);break;case P.Map:this.icon=new Path2D(F.PIN_MAP_KEY),this.secondaryIcon=new Path2D(F.PIN_MAP_VALUE);break;case P.None:default:this.icon=void 0}void 0===this.icon&&this._pinProperty.isReference&&(this._pinProperty.isLinked?this.icon=new Path2D(F.PIN_REFERENCE_CONNECTED):this.icon=new Path2D(F.PIN_REFERENCE_DISCONNECTED))}get pinProperty(){return this._pinProperty}set parent(e){this.controlParent=e;let t=this.findParent(z);t&&(1!=this.pinProperty.advancedView||t.showAdvanced||this.pinProperty.isLinked||(this.visible=!1))}addConnection(e){this.connections.push(e)}postInit(){this.pinProperty.shouldDrawDefaultValueBox&&this._pinProperty.defaultValueControlClass&&(this.defaultValueBox=new this._pinProperty.defaultValueControlClass(this._pinProperty.defaultValue),this.defaultValueBox.initControl(this.app),this.defaultValueBox.position.x=this.formattedNameWidth(this._pinProperty)+v.PINS_PADDING_HORIZONTAL+v.PINS_PADDING_LEFT_DEFAULT_BOX,this.defaultValueBox.padding.right=v.PINS_PADDING_LEFT_DEFAULT_BOX,this.defaultValueBox.padding.left=v.PINS_PADDING_LEFT_DEFAULT_BOX,this.width+=this.defaultValueBox.width+this.defaultValueBox.padding.left+this.defaultValueBox.padding.right,this.height+=this.defaultValueBox.padding.top+this.defaultValueBox.padding.bottom)}setHidden(e){this.hidden=e}onDraw(e){if(this.hidden)return;e.save();let t=this.pinProperty.category;e.fillStyle(this._color).strokeStyle(this._color);let i=this.pinProperty.direction===l.EGPD_Output?-this.padding.right:this.padding.left;switch(e.translate(i,Math.floor(.5*this.height)),t){case o.exec:this.drawExecutionPin(e);break;case o.delegate:this.drawDelegatePin(e);break;default:this.drawPin(e)}e.restore()}drawPinIcon(e,t){const i=Math.floor(this.getPinX());e.fillStyle(this._color).translate(i-7.5,-7.5).fill(this.icon,"evenodd"),void 0!==this.secondaryIcon&&e.fillStyle(this._secondaryColor).fill(this.secondaryIcon,"evenodd")}drawPin(e){let t=this.setupTextDrawing(e);const i=this.getPinX();e.fillText(this._pinProperty.formattedName,t,4),void 0===this.icon?(e.fillStyle(this._color).fillCircle(i+6,0,2.3),this._pinProperty.isLinked?e.fillCircle(i,0,6):(e.strokeStyle(this._color).lineWidth(2).strokeCircle(i,0,4.8),this.drawDefaultValueBox(e)),e.strokeStyle("#000").lineWidth(.5).strokeCircle(i,0,6)):this.icon&&this.drawPinIcon(e,this.icon)}drawExecutionPin(e){e.save();let t=this.setupTextDrawing(e);if(e.fillText(this._pinProperty.formattedName,t,4),this._pinProperty.formattedName){const t=this.setupTextDrawing(e);e.fillText(this._pinProperty.formattedName,t,4)}e.translate(this.getPinX(),-7),e.strokeStyle("#fff").fillStyle("#fff").lineWidth(1.1).beginPath().moveTo(-3,0).lineTo(1,0).lineTo(8,6).lineTo(8,8).lineTo(1,14).lineTo(-3,14).lineTo(-4,13).lineTo(-4,1).lineTo(-3,0).closePath(),this.pinProperty.isLinked?e.fill():e.stroke(),e.restore()}drawDelegatePin(e){e.save();let t=this.setupTextDrawing(e),i=this.getPinX();this.pinProperty.showInHead||(i-=4),e.fillText(this._pinProperty.formattedName,t,4),e.fillStyle(this._color).strokeStyle(this._color).lineWidth(2),this.pinProperty.isLinked?e.roundedRectangle(i,-5,11,11,3).fill():e.roundedRectangle(i,-5,10,10,3).stroke(),e.restore()}drawDefaultValueBox(e){this.defaultValueBox&&this.defaultValueBox.draw(e)}getPinX(){return this._isInput?v.PINS_PADDING_HORIZONTAL:this.size.x-v.PINS_PADDING_HORIZONTAL}setupTextDrawing(e){let t=this.size.x-(v.PIN_NAME_PADDING_LEFT+v.PINS_PADDING_HORIZONTAL);return this._isInput?(e.textAlign("left"),t=v.PIN_NAME_PADDING_LEFT+v.PINS_PADDING_HORIZONTAL):e.textAlign("right"),e.font("12px sans-serif").fillStyle("#eee"),t}formattedNameWidth(e){return this.app.canvas.font(b.NODE_FONT).getContext().measureText(e.formattedName).width+v.PIN_NAME_PADDING_LEFT}getPinAbsolutePosition(){let e=this.getAbsolutPosition();return e.y+=.5*this.height,this.pinProperty.direction===l.EGPD_Output?(e.x+=(this.width||this.size.x)-v.PINS_PADDING_HORIZONTAL,this.pinProperty.category===o.delegate&&(e.x+=8)):e.x+=v.PINS_PADDING_HORIZONTAL,e}}v.PIN_NAME_PADDING_LEFT=14,v.PIN_ICON_WIDTH=10,v.PINS_PADDING_HORIZONTAL=16,v.PINS_PADDING_LEFT_DEFAULT_BOX=8;class B extends M{constructor(e,t,i){super(e,t,i),this.drawChildren=!0,this.children=[]}refreshLayout(){super.refreshLayout(),this.applyFills()}draw(e){if(this.visible){if(e.save(),e.translate(Math.round(this.position.x),Math.round(this.position.y)),this.onDraw(e),this.drawChildren){e.save(),e.translate(Math.round(this.padding.left),Math.round(this.padding.top));for(let t of this.children)t.draw(e);e.restore()}e.restore()}}add(e){return this.children.push(e),e.parent=this,e}insert(e,t){return this.children.splice(t,0,e),e.parent=this,e}getChildren(){return this.children}getCalculatedSize(){let e=new d(0,0);for(let t of this.children){if(t.ignoreLayout)continue;let i=t.getCalculatedSize();e.x=Math.max(e.x,i.x),e.y=Math.max(e.y,i.y)}e.x+=this.padding.left+this.padding.right,e.y+=this.padding.top+this.padding.bottom,e.x=Math.max(e.x,this.minWidth||0),e.y=Math.max(e.y,this.minHeight||0),this.controlSize=e.copy();for(let e of this.children)e.fillParentHorizontal&&(e.desiredWidth=this.size.x-this.padding.left-this.padding.right),e.fillParentVertical&&(e.desiredHeight=this.size.y-this.padding.top-this.padding.top);return e}isDirty(){let e=this.dirty;for(let t of this.children)e=e||t.isDirty();return e}applyFills(e){for(let e of this.children)e instanceof B&&e.applyFills()}}!function(e){e[e.LEFT=0]="LEFT",e[e.CENTER=1]="CENTER",e[e.RIGHT=2]="RIGHT"}(A||(A={}));class G extends B{constructor(e,t,i){super(e,t,i),this.childAlignment=A.LEFT}onDraw(e){}getCalculatedSize(){let e=new d(0,0),t=0;this.verticalFillCount=0;for(let i of this.children){if(i.ignoreLayout||!i.visible)continue;let s=i.getCalculatedSize();i.position.y=e.y,e.x=Math.max(e.x,s.x),e.y+=s.y,i.fillParentVertical?this.verticalFillCount++:t+=s.y}return e.x=Math.max(e.x,this.minWidth||0),e.y=Math.max(e.y,this.minHeight||0),this.controlSize=e.copy(),this.childrenHeight=t,e.x+=this.padding.left+this.padding.right,e.y+=this.padding.top+this.padding.bottom,e}positionChildren(){if(this.childAlignment==A.RIGHT)for(let e of this.children){let t=this.size.x-this.padding.left-e.size.x;e.position.x=t}}applyFills(e){let t=(e?.y||this.size.y)-this.childrenHeight-(this.padding.top+this.padding.bottom),i=this.size.x,s=t/this.verticalFillCount,n=new d(this.padding.left,this.padding.top);for(let e of this.children)!e.ignoreLayout&&e.visible&&(e.position.x=n.x,e.position.y=n.y,e.fillParentHorizontal&&(e.desiredWidth=i),e.fillParentVertical&&(e.desiredHeight=s),n.y+=e.size.y+(e.padding.top||0)+(e.padding.bottom||0),e instanceof B&&e.applyFills(new d(i,s)));this.positionChildren()}}class k extends B{constructor(e,t,i){super(e,t,i)}onDraw(e){}getCalculatedSize(){let e=new d(0,0),t=0;this.horizontalFillCount=0;for(let i of this.children){if(i.ignoreLayout||!i.visible)continue;let s=i.getCalculatedSize();i.position.x=e.x,e.x+=s.x,e.y=Math.max(e.y,s.y),i.fillParentHorizontal?this.horizontalFillCount++:t+=s.x}return e.x=Math.max(e.x,this.minWidth||0),e.y=Math.max(e.y,this.minHeight||0),e.x=this.width||e.x,e.y=this.height||e.y,this.controlSize=e.copy(),this.childrenWidth=t,e.x+=this.padding.left+this.padding.right,e.y+=this.padding.top+this.padding.bottom,e}applyFills(e){let t=((e?.x||this.size.x)-this.childrenWidth-(this.padding.left+this.padding.right))/this.horizontalFillCount,i=this.size.y,s=new d(0,0);for(let e of this.children)!e.ignoreLayout&&e.visible&&(e.position.x=s.x,e.position.y=s.y,e.fillParentHorizontal&&(e.desiredWidth=t),e.fillParentVertical&&(e.desiredHeight=i),s.x+=e.size.x+(e.padding.left||0)+(e.padding.right||0),e instanceof B&&e.applyFills(new d(t,i)))}}class H extends M{constructor(e,t,i){super(),this.text=e,this.font=t||b.NODE_FONT,this.color=i||b.NODE_TEXT_COLOR,this.padding={top:0,right:0,bottom:0,left:0}}initialize(){let e=this.measureText();this.minWidth=e.width,this.minHeight=e.fontBoundingBoxAscent+e.fontBoundingBoxDescent,isNaN(this.minHeight)&&(e=this.measureText("|_"),this.minHeight=e.actualBoundingBoxAscent+e.actualBoundingBoxDescent+5),this.baseLine=Math.floor(this.minHeight/3)}onDraw(e){let t=this.getPosition();e.font(this.font).textAlign(this.textAlign).fillStyle(this.color).fillText(this.text,t.x,t.y)}measureText(e){return this.app.canvas.font(this.font).getContext().measureText(e||this.text)}getPosition(){let e=new d(0,0);switch(this.textAlign){case"center":e.x=.5*this.size.x,e.y=this.size.y+this.padding.top-this.baseLine;break;case"right":e.x=this.size.x-this.minWidth-this.padding.right,e.y=this.size.y+this.padding.top-this.baseLine;break;default:e.x=this.padding.left,e.y=this.size.y+this.padding.top-this.baseLine}return e}}class Z extends G{constructor(e,t){super(),this.color="rgb(160, 0, 0)",this.fillParentHorizontal=!0,this.minHeight=15,this.label=new H(e),this.label.fillParentHorizontal=!0,this.label.textAlign="center",this.label.padding={top:2,right:0,bottom:0,left:0},this.add(this.label),this.toolTip=t}onDraw(e){e.fillStyle(this.color).roundedRectangle(0,0,this.size.x,this.size.y,3).fill()}}class V extends M{constructor(e){super(),this.icon=new Path2D(e),this.width=22,this.height=20,this.padding={top:3,right:0,bottom:0,left:0}}onDraw(e){e.fillStyle(b.NODE_TEXT_COLOR).translate(this.padding.left,this.padding.top).fill(this.icon,"evenodd")}}class K extends V{constructor(e){super(e),this.ignoreLayout=!0,this.width=K.ICON_SIZE,this.height=K.ICON_SIZE}onDraw(e){e.fillStyle(b.NODE_TEXT_COLOR).translate(this.parent.size.x+this.padding.left-K.HALF_ICON_SIZE,-K.HALF_ICON_SIZE+this.padding.top).fill(this.icon,"evenodd")}}K.ICON_SIZE=22,K.HALF_ICON_SIZE=11;class z extends B{constructor(e){super(e.pos.x,e.pos.y),this.pins=[],this._node=e,this.width=0,this.height=0,this._selected=!1,this._stroke={lineWidth:1,style:"rgb(0,0,0)"},this.showAdvanced=e.advancedPinDisplay,this.mainPanel=new G,this.mainPanel.fillParentHorizontal=!0,this.add(this.mainPanel),this.pinPanel=new k,this.pinPanel.fillParentHorizontal=!0,this.mainPanel.add(this.pinPanel),this.inputPinPanel=new G,this.outputPinPanel=new G,this.outputPinPanel.childAlignment=A.RIGHT,this.outputPinPanel.fillParentHorizontal=!0,this.pinPanel.add(this.inputPinPanel),this.pinPanel.add(this.outputPinPanel),this.initErrorBar(),this.addInfoIcons()}initErrorBar(){if(void 0!==this.node.errorType&&void 0!==this.node.errorMsg&&1===this.node.errorType){let e=new Z("ERROR!",this.node.errorMsg);this.mainPanel.add(e)}}addInfoIcons(){this.node.latent&&this.mainPanel.add(new K(F.LATENT))}set selected(e){this._selected=e}get selected(){return this._selected}get sourceText(){return this._node.sourceText}get node(){return this._node}createPins(e){for(let e of this.node.customProperties)e instanceof m&&this.createPin(e)}createPin(e){let t=new v(this.position,e);this.pins.push(t),this.onPinCreated(t)}onPinCreated(e){e.pinProperty.direction===l.EGPD_Output?this.outputPinPanel.add(e):this.inputPinPanel.add(e)}onDraw(e){}drawStroke(e){this._selected?e.lineWidth(z._SELECTION_LINE_WIDTH).strokeStyle(z._SELECTION_COLOR):e.lineWidth(this._stroke.lineWidth).strokeStyle(this._stroke.style),e.stroke()}}z._SELECTION_COLOR="rgb(231,158,0)",z._SELECTION_LINE_WIDTH=2.5;class W extends z{constructor(e){super(e),this.zIndex=-100,this.width=e.width,this.height=e.height,this.applyCommentColor(e.backgroundColor)}onDraw(e){e.fillStyle(this.bodyBackgroundColor).font(b.NODE_FONT).roundedRectangle(0,0,this.width,this.height,5).fill(),this.drawTitle(e),e.roundedRectangle(0,0,this.width,this.height,5),this.drawStroke(e)}applyCommentColor(e){null!=e&&""!=e||(e=W._DEFAULT_COMMENT_COLOR);let t=new R(e);t.applyGamma(),t.A=.3*t.A,this.bodyBackgroundColor=t.toRGBAString(),t.darken(.3),this.headerBackgroundColor=t.toRGBString()}drawTitle(e){const t=new d(9,23);e.fillStyle(this.headerBackgroundColor).roundedRectangle(0,0,this.width,32,{radiusTopLeft:5,radiusTopRight:5,radiusBottomLeft:0,radiusBottomRight:0}).fill().font("600 18px sans-serif").textAlign("left").strokeStyle("#333").lineWidth(1.5).strokeText(this.node.title,t.x+1,t.y+1).fillStyle(W._HEADER_TEXT_COLOR).fillText(this.node.title,t.x,t.y)}}W._HEADER_TEXT_COLOR="rgb(238,238,238)",W._DEFAULT_COMMENT_COLOR="rgba(255,255,255,1)";class X{constructor(e){this._propertyParsers={},this._propertyParsers=e}parse(e){throw new Error("Not implemented! A derived class does not override the 'parse' function of the abstract class 'NodeParser'.")}parseProperties(e){for(let t=e.unparsedLines.length-1;t>=0;t--){const i=e.unparsedLines[t];this.parseProperty(e.node,i)&&e.unparsedLines.splice(t,1)}}parseProperty(e,t){const i=t.split("=");let s=i.shift();const n=i.join("=");s=s.replace(/\((.+)\)/g,"");const r=this._propertyParsers[s];return!!r&&(r(e,n),!0)}}class j extends X{constructor(){super({CommentColor:(e,t)=>{e.backgroundColor=D.parseColor(t)},NodeWidth:(e,t)=>{e.width=Number.parseInt(t)},NodeHeight:(e,t)=>{e.height=Number.parseInt(t)},NodeComment:(e,t)=>{e.title=t.replace(/"/g,"")}})}parse(e){return this.parseProperties(e),new W(e.node)}}class Y extends k{constructor(e,t){super(),this.headerHeight=Y.HEADER_TITLE_HEIGHT,this.icon=void 0,this.node=e,this.padding={top:2,right:0,bottom:0,left:7},t&&(this.icon=new V(t),this.add(this.icon)),this.titlePanel=new G,this.titlePanel.padding={top:0,right:0,bottom:0,left:0};let i=new H(e.title,b.NODE_HEADER_FONT);i.color=b.NODE_TEXT_COLOR,i.padding={top:6,right:0,bottom:3,left:0},this.titlePanel.add(i);let s=this.node.subTitles.sort(((e,t)=>(t.orderIndex||0)-(e.orderIndex||0)));for(const e of s){let t=new H(e.text,b.NODE_FONT,b.NODE_SUBTITLE_COLOR);this.titlePanel.add(t)}this.add(this.titlePanel),this.delegatePanel=new G,this.delegatePanel.fillParentHorizontal=!0,this.delegatePanel.minWidth=28,this.add(this.delegatePanel)}initialize(){this.fillStyleHeader=this.getHeaderFillStyle()}onDraw(e){e.fillStyle(this.fillStyleHeader).roundedRectangle(1,1,this.size.x-2,this.size.y,{radiusTopLeft:5,radiusTopRight:5,radiusBottomLeft:0,radiusBottomRight:0}).fill()}getHeaderFillStyle(){const e=this.node.backgroundColor||Y.NODE_DEFAULT_BACKGROUND_COLOR,t=this.app.canvas.getContext().createLinearGradient(0,0,150,0);return t.addColorStop(0,`rgb(${e})`),t.addColorStop(1,`rgba(${e},0.15)`),t}addDelegate(e){this.delegatePanel.add(e)}}Y.HEADER_TITLE_HEIGHT=23,Y.NODE_DEFAULT_BACKGROUND_COLOR="78, 117, 142";class q extends G{constructor(e){super(),this.color="#FFE32F",this.svg=new Image,this.svg.src="data:image/svg+xml,"+escape('<svg width="32px" height="32px" viewBox="0 12 32 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><path d="M16,6.988l-16,0l-16,18.024l16,-0l16,-18.024Z" style="fill:'+this.color+';fill-opacity:0.4;"/><path d="M48,6.988l-16,0l-16,18.024l16,-0l16,-18.024Z" style="fill:'+this.color+';fill-opacity:0.4;"/></svg>'),this.svg.width="25px",this.svg.height="22px",this.svg.onload=()=>{this.imageLoaded()},this.fillParentHorizontal=!0,this.minHeight=22,this.label=new H(e),this.label.fillParentHorizontal=!0,this.label.textAlign="center",this.label.padding={top:3,right:0,bottom:2,left:0},this.add(this.label)}onDraw(e){e.fillStyle(this.pattern),e.fillRect(0,0,this.size.x,this.size.y)}imageLoaded(){this.pattern=this.app.canvas.getContext().createPattern(this.svg,"repeat"),this.app.scene.refresh()}}class $ extends z{constructor(e,t){super(e),this.headerHeight=$.NODE_HEADER_TITLE_HEIGHT,this.minHeight=$.NODE_HEADER_TITLE_HEIGHT,this.header=new Y(e,t),this.header.fillParentHorizontal=!0,this.pinPanel.padding={top:3,right:0,bottom:3,left:0},this.createPins(new d(0,this.headerHeight)),this.mainPanel.insert(this.header,0),this.initializeEnabledState()}initializeEnabledState(){void 0!==this.node.enabledState&&this.mainPanel.add(new q(E(this.node.enabledState)))}createPin(e){let t=new v(this.position,e);if(this.pins.push(t),e.direction==l.EGPD_Output){if(e.showInHead)return t.fillParentVertical=!0,void this.header.addDelegate(t);this.outputPinPanel.add(t)}else this.inputPinPanel.add(t)}onDraw(e){super.onDraw(e),e.fillStyle(b.NODE_BACKGROUND_COLOR).font(b.NODE_FONT).roundedRectangle(0,0,this.size.x,this.size.y,5).fill(),e.roundedRectangle(0,0,this.size.x,this.size.y,5),this.drawStroke(e)}}$.NODE_HEADER_TITLE_HEIGHT=23,$.NODE_HEADER_SUBTITLE_HEIGHT=14,$.NODE_HEADER_SPACE_BETWEEN_TITLE_AND_SUBTITLE=4,$.NODE_HEADER_ICONS_WIDTH=50;class J extends M{constructor(e){super(),this.fillParentVertical=!0,this.minWidth=e,this.padding={top:0,right:0,bottom:0,left:0}}onDraw(e){}}class Q extends z{constructor(e){super(e),this.minHeight=32,this.padding={top:2,right:0,bottom:0,left:0},this.createPins(new d(0,0))}initialize(){if(this.node.title){const e=this.measureText(b.NODE_MATHFUNC_TITLE_FONT,this.node.title).width+32,t=new J(e);t.fillParentVertical=!0,this.pinPanel.insert(t,1)}}onDraw(e){e.fillStyle(Q._NODE_BACKGROUND_COLOR).roundedRectangle(0,0,this.size.x,this.size.y,16).fill(),this.drawTitle(e),this.drawFirstSubTitle(e),this.drawStroke(e)}drawTitle(e){this.node.title&&e.font(b.NODE_MATHFUNC_TITLE_FONT).textAlign("center").fillStyle(b.NODE_MATHFUNC_TITLE_COLOR).fillText(this.node.title,.5*this.size.x,.5*this.size.y+8)}drawFirstSubTitle(e){this.node.subTitles&&0!==this.node.subTitles.length&&e.font(b.NODE_MATHFUNC_SUBTITLE_FONT).textAlign("center").fillStyle(b.NODE_MATHFUNC_TITLE_COLOR).fillText(this.node.subTitles[0].text,.5*this.size.x,.5*this.size.y+22)}measureText(e,t){return this.app.canvas.font(e).getContext().measureText(t)}}Q._NODE_BACKGROUND_COLOR="rgba(15,15,15,0.6)";class ee extends X{parse(e){const t=e.node,i=ee.MATH_FUNCTIONS.find((e=>t.functionReference.memberName.startsWith(e.name)));return t.subTitles=[],t.isPrimitiveNode=!!i,t.isPrimitiveNode?(t.title=i.displayName,D.hidePinNames(t.customProperties),new Q(t)):new $(t,this.getIconForHeadedNode(t))}getIconForHeadedNode(e){return e.functionReference.memberName.startsWith("Make")?F.MAKE_STRUCT:e.functionReference.memberName.startsWith("Break")?F.BREAK_STRUCT:F.FUNCTION}}ee.MATH_FUNCTIONS=[{name:"Multiply",displayName:""},{name:"Divide",displayName:""},{name:"Add",displayName:"+"},{name:"Subtract",displayName:"-"},{name:"Percent",displayName:"%"},{name:"FMax",displayName:"MAX"},{name:"Max",displayName:"MAX"},{name:"FMin",displayName:"MIN"},{name:"Min",displayName:"MIN"},{name:"Dot",displayName:""},{name:"LessEqual",displayName:"<="},{name:"Less",displayName:"<"},{name:"GreaterEqual",displayName:">="},{name:"Greater",displayName:">"},{name:"Abs",displayName:"ABS"},{name:"Exp",displayName:"e"},{name:"Sqrt",displayName:"SQRT"},{name:"Square",displayName:"^2"},{name:"NotEqual",displayName:"!="},{name:"Not",displayName:"NOT"},{name:"EqualEqual",displayName:"=="},{name:"BooleanOR",displayName:"OR"},{name:"BooleanXOR",displayName:"XOR"},{name:"BooleanNOR",displayName:"NOR"},{name:"BooleanAND",displayName:"AND"},{name:"BooleanNAND",displayName:"NAND"}];class te{constructor(){this.FUNCTION_NAMES={K2_GetComponentRotation:"GetWorldRotation",GreaterGreater_VectorRotator:"RotateVector"}}parse(e){let t={};const i=(e=(e=e.trim()).substr(1,e.length-2)).split(",");for(let e=0;e<i.length;++e){let s=i[e].split("="),n=s[0],r=s[1];switch(n){case"MemberName":t.memberName=this.translateFunctionName(D.parseString(r));break;case"MemberParent":t.memberParent=te.parseClassReference(r);break;case"MemberGuid":t.memberGUID=r;break;case"bSelfContext":t.selfContext="True"==r}}return t}translateFunctionName(e){for(let t in this.FUNCTION_NAMES){let i=this.FUNCTION_NAMES[t];e=e.replace(t,i)}return e}static parseClassReference(e){const t=e.substring(0,e.indexOf("'")),i=e.substring(e.indexOf("'")).replace(/['"]/g,"");return{type:t,classPath:i,className:D.getClassFriendlyName(i)}}}class ie extends M{onDraw(e){}onMouseDown(e){return!1}onMouseUp(e){return!1}onMouseEnter(e){return!1}onMouseLeave(e){return!1}onMouseMove(e){return!1}}class se extends ie{get foldoutState(){return this.foldout}set foldoutState(e){this.foldout=e,this.app.scene.refresh()}constructor(e){super(),this.foldout=!1,this.hovered=!1,this.height=se.BUTTON_HEIGHT,this.fillParentHorizontal=!0,this.padding={top:0,right:0,bottom:3,left:0},this.foldout=e,this.zIndex=1}onMouseEnter(e){return this.hovered=!0,this.app.scene.refresh(),!0}onMouseLeave(e){return this.hovered=!1,this.app.scene.refresh(),!0}onMouseDown(e){return!0}onMouseUp(e){return this.foldoutState=!this.foldoutState,this.onClick&&this.onClick(this.foldoutState),!0}onDraw(e){this.hovered&&e.fillStyle("rgba(255,255,255,0.1)").fillRect(0,0,this.size.x,this.size.y),this.drawChevron(e)}drawChevron(e){e.save(),e.translate(.5*this.size.x,.5*this.size.y),e.fillStyle("#eee").beginPath(),this.foldoutState?e.moveTo(5,5).lineTo(0,-2).lineTo(-5,5).lineTo(5,5):e.moveTo(5,-2).lineTo(0,5).lineTo(-5,-2).lineTo(5,-2),e.fill(),e.restore()}}se.BUTTON_HEIGHT=20,se.BUTTON_MARGIN=3;class ne extends ${constructor(e,t){super(e,t),this.foldState=!1,this.foldState=void 0===e.advancedPinDisplay||e.advancedPinDisplay,this.nodeButton=new se(this.foldState),this.mainPanel.add(this.nodeButton),this.nodeButton.onClick=e=>this.toggleFold(e)}toggleFold(e){this.foldState=e,this.applyAdvancedView(this.foldState),this.app.scene.refresh()}applyAdvancedView(e){for(let t of this.pins)!0!==t.pinProperty.advancedView||t.pinProperty.isLinked||(t.visible=e);this.nodeButton.refreshLayout(),this.refreshLayout();for(let e of this.pins)e.refreshLayout()}}class re extends X{parse(e){const t=e.node,i=re.STR_FUNCTIONS.find((e=>t.functionReference.memberName.startsWith(e.name)));return i&&(t.title=i.displayName),t.subTitles=[],!0===i?.isPrimitive?(D.hidePinNames(t.customProperties),new Q(t)):new $(t,F.FUNCTION)}}re.STR_FUNCTIONS=[{name:"Concat_StrStr",displayName:"Append"},{name:"Conv_",displayName:"",isPrimitive:!0}];class oe extends X{parse(e){const t=e.node;let i=!1;const s=oe.FUNCTIONS.find((e=>t.functionReference.memberName===e.name));return s?(t.title=s.displayName,i=s.isPrimitive):t.functionReference.memberName.startsWith("Array_")&&(t.title=t.functionReference.memberName.substr(6),t.title=T(t.title).toUpperCase(),i=!0),t.subTitles=[],!0===i?(D.hidePinNames(t.customProperties),new Q(t)):new $(t,F.FUNCTION)}}oe.FUNCTIONS=[{name:"Array_Identical",displayName:"==",isPrimitive:!0},{name:"Array_Remove",displayName:"REMOVE INDEX",isPrimitive:!0},{name:"Array_RemoveItem",displayName:"REMOVE",isPrimitive:!0},{name:"Array_RandomFromStream",displayName:"Random Array Item from Stream",isPrimitive:!1},{name:"Array_Set",displayName:"Set Array Elem",isPrimitive:!1}];class le extends X{constructor(){super({bIsPureFunc:(e,t)=>{e.isPureFunc="True"===t},bIsConstFunc:(e,t)=>{e.isConstFunc="True"===t},FunctionReference:(e,t)=>{const i=new te;if(e.functionReference=i.parse(t),e.title=T(g(e.functionReference.memberName)),!0===e.functionReference.selfContext)e.subTitles.push({text:"Target is self context"});else if(e.functionReference?.memberParent?.className){const t=e.customProperties.find((e=>"self"===e?.name?.toLowerCase()));if(t&&!t.hidden){const t=E(e.functionReference?.memberParent?.className);e.subTitles.push({text:`Target is ${t}`})}}}})}parse(e){const t=e.node;this.parseProperties(e),t.backgroundColor=!0===t.isPureFunc?b.DEFAULT_FUNC_PURE_BACKGROUND_COLOR:b.DEFAULT_FUNC_BACKGROUND_COLOR;let i=F.FUNCTION;t.class===y.FUNCTION_ENTRY&&(i=this.handleFunctionNode(t));const s=le._FUNCTION_MAP[t.functionReference?.memberParent?.classPath];return s?s(e):void 0!==t.advancedPinDisplay?new ne(t,i):new $(t,i)}handleFunctionNode(e){return e.backgroundColor=b.DEFAULT_FUNC_ENTRY_BACKGROUND_COLOR,e.title=T(e.functionReference.memberName.replace("UserConstructionScript","ConstructionScript")),F.BREAK_STRUCT}}le._FUNCTION_MAP={"/Script/Engine.KismetMathLibrary":e=>(new ee).parse(e),"/Script/Engine.KismetStringLibrary":e=>(new re).parse(e),"/Script/Engine.KismetArrayLibrary":e=>(new oe).parse(e)};class ae extends X{constructor(){super({InputAxisName:(e,t)=>{e.inputAxisName=t.replace(/"/g,""),e.title="InputAxis "+e.inputAxisName},CustomFunctionName:(e,t)=>{e.customFunctionName=t}})}parse(e){return this.parseProperties(e),e.node.backgroundColor=ae._DEFAULT_BACKGROUND_COLOR,D.configureFirstDelegatePinInHead(e.node.customProperties),new $(e.node,F.EVENT)}}ae._DEFAULT_BACKGROUND_COLOR="156, 36, 35",function(e){e[e.Getter=0]="Getter",e[e.Setter=1]="Setter"}(x||(x={}));class ce extends Q{constructor(e){super(e),this.minWidth=124}drawTitle(e){e.font("bold 18px sans-serif").textAlign("center").fillStyle(b.NODE_MATHFUNC_TITLE_COLOR).fillText("SET",this.size.x/2,22)}}class he extends X{constructor(){super({VariableReference:(e,t)=>{const i=new te;e.variableReference=i.parse(t)}})}parse(e){this.parseProperties(e);const t=e.node,i=e.node.class===y.VARIABLE_SET;return t.variableType=x.Getter,i?(t.variableType=x.Setter,e.node.title="",this.hideOutputPinNames(t),new ce(e.node)):(e.node.title=void 0,new Q(e.node))}hideOutputPinNames(e){for(let t=e.customProperties.length-1;t>=0;t--){if(e.customProperties[t]instanceof m==!1)continue;const i=e.customProperties[t];i.direction===l.EGPD_Output&&(i.hideName=!0)}}}class de extends M{constructor(e){super(),this.color=e,this.height=b.DEFAULT_BOX_HEIGHT,this.width=this.height,this.padding.top=1,this.padding.bottom=1}onDraw(e){e.roundedRectangle(0,0-b.DEFAULT_BOX_HEIGHT/2,this.width,this.height,b.DEFAULT_BOX_RADIUS).fillStyle(this.color.toRGBAString()).fill()}}class pe{}class ue extends M{constructor(e){super(),this.height=b.DEFAULT_BOX_HEIGHT,this.entries=e,this.padding.top=1,this.padding.bottom=1}initialize(){let e=0;this.entries.forEach((t=>{const i=this.app.canvas.getContext().measureText(`${t.key}`).width+3,s=i+this.app.canvas.getContext().measureText(`${t.value}`).width+2*b.DEFAULT_VALUE_BOX_TEXT_PADDING;this.entries.push({key:t.key,value:t.value,x:e,keyWidth:i,boxWidth:s}),e+=s+5})),this.width=e}onDraw(e){this.entries.forEach((t=>{e.roundedRectangle(t.x,0-b.DEFAULT_BOX_HEIGHT/2,t.boxWidth,b.DEFAULT_BOX_HEIGHT,b.DEFAULT_BOX_RADIUS).fillStyle("rgba(70,70,70,0.5)").fill(),e.textAlign("left").font("10px sans-serif").fillStyle("#999").fillText(`${t.key}`,t.x+b.DEFAULT_VALUE_BOX_TEXT_PADDING,b.DEFAULT_VALUE_BOX_TEXT_PADDING),e.textAlign("left").font(b.NODE_FONT).fillStyle("#ccc").fillText(`${t.value}`,t.x+t.keyWidth+b.DEFAULT_VALUE_BOX_TEXT_PADDING,b.DEFAULT_VALUE_BOX_TEXT_PADDING)}))}}class _e extends M{constructor(e){super(),this.text=e,this.height=b.DEFAULT_BOX_HEIGHT,this.padding.top=1,this.padding.bottom=1}initialize(){this.width=this.app.canvas.getContext().measureText(this.text).width+2*b.DEFAULT_VALUE_BOX_TEXT_PADDING}onDraw(e){e.roundedRectangle(0,0-b.DEFAULT_BOX_HEIGHT/2,this.width,b.DEFAULT_BOX_HEIGHT,b.DEFAULT_BOX_RADIUS).fillStyle("rgba(70,70,70,0.5)").fill().font(b.NODE_FONT).fillStyle("#ccc").textAlign("left").fillText(this.text,b.DEFAULT_VALUE_BOX_TEXT_PADDING,b.DEFAULT_VALUE_BOX_TEXT_PADDING)}}class me extends M{constructor(e){super(),this.isTrue=e,this.width=b.DEFAULT_BOX_HEIGHT,this.height=b.DEFAULT_BOX_HEIGHT,this.padding.top=1,this.padding.bottom=1}onDraw(e){const t=new Path2D(F.DEFAULT_VALUE_BOOL_TRUE);e.roundedRectangle(0,0-b.DEFAULT_BOX_HEIGHT/2,b.DEFAULT_BOX_HEIGHT-1,b.DEFAULT_BOX_HEIGHT-1,b.DEFAULT_BOX_RADIUS).fillStyle("rgba(50,50,50,0.5)").fill(),e.strokeStyle("rgba(70,70,70,0.7)").lineWidth(2).stroke(),this.isTrue&&e.fillStyle(b.NODE_TEXT_COLOR).translate(-.5,-b.DEFAULT_BOX_HEIGHT/2).fill(t,"evenodd")}}class fe{parse(e,t){this._property=new m(t);const i=e.matchAll(/([a-zA-Z0-9_.]+)\s*=\s*(("[^"]*")|(\([^)]*\))|(\w*\(\w*(?:[^(]*\([^)]*(?:"[^"]*")\))*\))|(\w*\([^)]*\([^)]*\)[^)]*\))|(\w*\([^)]*\))|([^,]*))/g);for(const[e,t,s]of i){if(!e||!t){console.warn(`Skipped property attribute because invalid key: '${e}'`);continue}const i=fe._ATTRIBUTE_PARSERS[t];i?i(this._property,s):console.info(`Didn't parse property attribute '${t}'. There isn't a matching parser.`)}return fe.setDefaultValueIfUndefined(this._property),this._property}static parseLinkedTo(e){let t=[],i=(e=e.substr(1,e.length-1)).split(",");for(let e=0;e<i.length;++e){let s=i[e].split(" ");if(2==s.length){let e=new pe;e.nodeName=s[0],e.pinID=s[1],t.push(e)}}return t}static parseSubCategoryObject(e){let t=e,i=e.substring(0,e.indexOf("'")),s=e.matchAll(/'"(.*)"'/g);if(s){let e=s.next();e&&e.value&&(t=e.value[1])}return{type:i,class:t}}static parsePinFriendlyName(e){let t="";if(e.startsWith("NSLOCTEXT")){let i="NSLOCTEXT(".length-1,s=(e=e.substr(i,e.length-i-1)).split(",");return t=s[s.length-1].replace(/"/g,""),t}if(e.startsWith("LOCGEN_FORMAT_NAMED")){let t,i,s="LOCGEN_FORMAT_NAMED(".length,n="",r={},o=(e=e.substring(s,e.length-1)).matchAll(/(\w*\((?:"[^"]*"[, ]*)+\))|("[^"]*")/g),l=0,a=0;for(const[e,s,c]of o){let s=e;if(s=s.trim(),s.startsWith("NSLOCTEXT")){l-=1,s=s.substring("NSLOCTEXT(".length,s.length-1);let e=s.split(","),i=e[0].trim().replace(/"/g,""),o=(e[1].trim().replace(/"/g,""),e[2].trim().replace(/"/g,""));"KismetSchema"===i&&(n=o),""===i&&(i=t,r[i]=o)}else(a+l)%2==0?i=s.replace(/"/g,""):r[i]=s.replace(/"/g,"");t=s.replace(/"/g,""),a++}let c=n;for(let e in r){let t=r[e],i=new RegExp("{"+e+"}","g");c=c.replace(i,t)}return c}return t=e.replace(/"/g,""),t}static parsePinCategory(e){return(e=D.parseString(e)).toLowerCase()}static parseDirection(e){return"EGPD_Output"===(e=e.replace(/"/g,""))?l.EGPD_Output:l.EGPD_Input}static parseDefaultValue(e,t){if(t)switch(e.category){case o.float:return{control:_e,data:N(D.parseString(t))};case o.bool:return{control:me,data:"true"===D.parseString(t).toLowerCase()};case o.struct:return this.parseDefaultValueStruct(e.subCategoryObject.class,t);case o.byte:return"Enum"===e.subCategoryObject.type?{control:_e,data:D.parseEnumValue(e.subCategoryObject.class,t)}:{control:_e,data:D.parseString(t)};default:return{control:_e,data:D.parseString(t)}}}static parseEnumValue(){}static parseDefaultValueStruct(e,t){switch(e){case O.VECTOR:case O.ROTATOR:return{control:ue,data:this.parseDefaultValueVector(t)};case O.LINEAR_COLOR:const e=this.parseDefaultValueStructCommon(t).map((e=>Number(e.value))),i=new R(255*(e[0]||0),255*(e[1]||0),255*(e[2]||0),e[3]);return i.applyGamma(),{control:de,data:i};default:return{control:ue,data:this.parseDefaultValueStructCommon(t)}}}static parseDefaultValueVector(e){const t=["X","Y","Z"];let i=[];e.split(",").forEach((e=>{i.push(N(D.parseString(e)))}));for(let e=0;e<i.length;e++)i[e]={key:t[e],value:i[e]};return i}static parseDefaultValueStructCommon(e){let t=[];return(e=(e=D.parseString(e)).trim().replace(/[()]/g,"")).split(",").forEach((e=>{const[i,s]=e.split("=");t.push({key:i,value:N(s)})})),t}static parseDefaultValueText(e){const t=/(?<=")([^"]+)(?="\))/g.exec(e.trim());return t?t[0]:e}static setDefaultValueIfUndefined(e){if(null==e.defaultValue)switch(e.category){case o.bool:e.defaultValue=!1,e.defaultValueControlClass=me;case o.string:e.defaultValue="  ",e.defaultValueControlClass=_e;case o.struct:if(e.subCategoryObject.class===O.VECTOR2D)e.defaultValue=[{key:"X",value:"0.0"},{key:"Y",value:"0.0"}],e.defaultValueControlClass=ue}}}S=fe,fe._ATTRIBUTE_PARSERS={PinId:(e,t)=>{e.id=t},PinName:(e,t)=>{e.name=E(D.parseString(t))},PinFriendlyName:(e,t)=>{e.friendlyName=E(fe.parsePinFriendlyName(t))},"PinType.PinCategory":(e,t)=>{e.category=fe.parsePinCategory(t)},Direction:(e,t)=>{e.direction=fe.parseDirection(t)},PinToolTip:(e,t)=>{e.toolTip=D.parseString(t)},"PinType.PinSubCategory":(e,t)=>{e.subCategory=D.parseString(t)},"PinType.PinSubCategoryObject":(e,t)=>{e.subCategoryObject=fe.parseSubCategoryObject(t)},"PinType.bIsReference":(e,t)=>{e.isReference="true"===t.toLowerCase()},"PinType.bIsConst":(e,t)=>{e.isConst="true"===t.toLowerCase()},"PinType.bIsWeakPointer":(e,t)=>{e.isWeakPointer="true"===t.toLowerCase()},"PinType.bIsUObjectWrapper":(e,t)=>{e.isUObjectWrapper="true"===t.toLowerCase()},DefaultValue:(e,t)=>{const i=S.parseDefaultValue(e,t);e.defaultValue=i.data,e.defaultValueControlClass=i.control},DefaultObject:(e,t)=>{const i=D.parseString(t),s=D.getClassFriendlyName(i);s&&(e.defaultValue=s,e.defaultValueControlClass=_e)},DefaultTextValue:(e,t)=>{e.defaultValue=S.parseDefaultValueText(t),e.defaultValueControlClass=_e},AutogeneratedDefaultValue:(e,t)=>{e.autogeneratedDefaultValue=D.parseString(t)},LinkedTo:(e,t)=>{e.linkedTo=fe.parseLinkedTo(t)},bHidden:(e,t)=>{e.hidden="true"===t.toLowerCase()},bDefaultValueIsIgnored:(e,t)=>{e.defaultValueIsIgnored="true"===t.toLowerCase()},bDefaultValueIsReadOnly:(e,t)=>{e.defaultValueIsReadOnly="true"===t.toLowerCase()},bAdvancedView:(e,t)=>{e.advancedView="true"===t.toLowerCase()},bOrphanedPin:(e,t)=>{e.orphanedPin="true"===t.toLowerCase()},bNotConnectable:(e,t)=>{e.notConnectable="true"===t.toLowerCase()},PersistentGuid:(e,t)=>{e.persistentGUID=D.parseString(t)},"PinType.ContainerType":(e,t)=>{e.containerType=t},"PinType.PinValueType":(e,t)=>{void 0!==(t=(t=t.replace(/[\(\)]/g,"")).split("=")[1])&&(e.valueType=t.replace(/"/g,""))},"PinType.PinSubCategoryMemberReference":(e,t)=>{}};class Te extends X{parse(e){const t=Te._NODE_TITLES[e.node.class];return e.node.title=t.title,e.node.backgroundColor=Te._DEFAULT_BACKGROUND_COLOR,new $(e.node,t.icon)}}Te._DEFAULT_BACKGROUND_COLOR="150, 150, 150",Te._NODE_TITLES={[y.IF_THEN_ELSE]:{title:"Branch",icon:F.BRANCH},[y.EXECUTION_SEQUENCE]:{title:"Sequence",icon:F.SEQUENCE},[y.MULTI_GATE]:{title:"Multi Gate",icon:F.SEQUENCE}};class ge extends z{constructor(e){super(e),this.width=16,this.height=16,this._stroke.lineWidth=.5,this.drawChildren=!1,this.color=U.getPinColor(e.customProperties[0]),this.mainPanel.width=0,this.createPins()}onPinCreated(e){e.ignoreLayout=!0,this.mainPanel.add(e),e.position.y=8,e.width=20,e.height=0,e.visible=!1}onDraw(e){e.translate(8,8).fillStyle(this.color).fillCircle(6,0,2.3).fillCircle(0,0,6),this.drawStroke(e)}}class Ee extends X{parse(e){return e.node.backgroundColor=Ee._DEFAULT_BACKGROUND_COLOR,new ge(e.node)}}Ee._DEFAULT_BACKGROUND_COLOR="255, 255, 255",function(e){e[e.NotReplicated=0]="NotReplicated",e[e.Multicast=1]="Multicast",e[e.RunOnServer=2]="RunOnServer",e[e.RunOnOwningClient=3]="RunOnOwningClient"}(w||(w={}));class Ne extends X{constructor(){super({CustomFunctionName:(e,t)=>{e.customFunctionName=t.replace(/"/g,""),e.title=e.customFunctionName,e.subTitles.unshift({text:"Custom Event"})},FunctionFlags:(e,t)=>{if(e.functionFlags=Number.parseInt(t),e.reliable=0!=(e.functionFlags&Ne.FUNCTION_FLAG_RELIABLE),e.replicationType=this.getReplicationType(e.functionFlags),e.replicationType!==w.NotReplicated){const t=w[e.replicationType],i=Ne.REPLICATION_TYPE_TEXTS[t];e.subTitles.unshift({text:i,orderIndex:1})}},ErrorType:(e,t)=>{e.errorType=Number.parseInt(t)}})}parse(e){return this.parseProperties(e),D.configureFirstDelegatePinInHead(e.node.customProperties),e.node.backgroundColor=Ne._DEFAULT_BACKGROUND_COLOR,new $(e.node,F.CUSTOM_EVENT)}getReplicationType(e){for(const t in Ne.FUNCTION_FLAG_BIT_MASKS)if(Object.prototype.hasOwnProperty.call(Ne.FUNCTION_FLAG_BIT_MASKS,t)){if(0!=(e&Ne.FUNCTION_FLAG_BIT_MASKS[t]))return w[t]}return w.NotReplicated}}Ne.FUNCTION_FLAG_RELIABLE=64,Ne.FUNCTION_FLAG_BIT_MASKS={[w.Multicast]:16384,[w.RunOnServer]:2097152,[w.RunOnOwningClient]:16777216},Ne.REPLICATION_TYPE_TEXTS={[w.Multicast]:"Executes On All",[w.RunOnServer]:"Executes On Server",[w.RunOnOwningClient]:"Executes On Owning Client"},Ne._DEFAULT_BACKGROUND_COLOR="156, 36, 35";class Ce extends X{constructor(){super({EventReference:(e,t)=>{const i=new te;e.eventReference=i.parse(t),e.title="Event "+e.eventReference.memberName.replace("Receive","")},bOverrideFunction:(e,t)=>{e.overrideFunction="True"===t}})}parse(e){return this.parseProperties(e),e.node.backgroundColor=Ce._DEFAULT_BACKGROUND_COLOR,D.configureFirstDelegatePinInHead(e.node.customProperties),new $(e.node,F.EVENT)}}Ce._DEFAULT_BACKGROUND_COLOR="156, 36, 35";class ye extends X{constructor(){super({InputKey:(e,t)=>{e.inputKey=t},bControl:(e,t)=>{e.control="true"===t.toLowerCase()},bAlt:(e,t)=>{e.alt="true"===t.toLowerCase()},bShift:(e,t)=>{e.shift="true"===t.toLowerCase()},bCommand:(e,t)=>{e.command="true"===t.toLowerCase()}})}parse(e){this.parseProperties(e),e.node.backgroundColor=ye.DEFAULT_BACKGROUND_COLOR;let t=e.node,i=[],s="";t.control&&i.push("Ctrl"),t.command&&i.push("Cmd"),t.alt&&i.push("Alt"),t.shift&&i.push("Shift"),i.length>0&&(s=i.join("+")+" "),s+=E(t.inputKey),s=s.replace("Magic Leap","ML");let n=F.INPUT_KEY;return(t.inputKey.startsWith("Gamepad_")||t.inputKey.startsWith("MagicLeap_"))&&(n=F.INPUT_GAMEPAD),e.node.title=s,new $(e.node,n)}}ye.DEFAULT_BACKGROUND_COLOR="156, 36, 35";class Pe extends X{constructor(){super({TargetType:(e,t)=>{e.targetType=te.parseClassReference(t)}})}parse(e){this.parseProperties(e);let t=e.node;return t.title="Cast to "+t.targetType.className,t.backgroundColor="32, 116, 120",new $(e.node,F.CAST)}}class Oe extends X{constructor(){super({Enum:(e,t)=>{e.enum=D.parseString(t)},EnumEntries:(e,t)=>{e.enumEntries||(e.enumEntries=[]),e.enumEntries.push(D.parseString(t))}})}parse(e){this.parseProperties(e);let t=e.node;return t.title="Switch on "+D.getClassFriendlyName(t.enum),t.backgroundColor="162, 161, 35",new ne(e.node,F.SWITCH)}}class Ae{parse(e){let t={};const i=(e=(e=e.trim()).substr(1,e.length-2)).split(",");for(let e=0;e<i.length;++e){let s=i[e].split("="),n=s[0],r=s[1];if("MacroGraph"===n)t.macroFuncName=Ae.extractNodeNameOfMacroGraphStr(r.substring(r.indexOf("'")))}return t}static extractNodeNameOfMacroGraphStr(e){const t=D.parseString(e),i=/(?<=\:)\w*/g.exec(t);return i?i[0]:t}}class xe extends X{constructor(){super({MacroGraphReference:(e,t)=>{const i=new Ae;e.macroGraphReference=i.parse(t),e.title=T(e.macroGraphReference.macroFuncName)}})}parse(e){this.parseProperties(e);const t=e.node,i=xe.getIconForMacro(t.macroGraphReference.macroFuncName);e.node.backgroundColor=xe._DEFAULT_BACKGROUND_COLOR;const s=xe._HEADLESS_NODES.find((e=>e.name===t.macroGraphReference?.macroFuncName));return s?(t.title=s.displayName,D.hidePinNames(t.customProperties),new Q(e.node)):new $(e.node,i)}static getIconForMacro(e){switch(e){case"ForLoop":case"ForLoopWithBreak":case"WhileLoop":return F.LOOP;case"Gate":return F.GATE;case"FlipFlop":return F.FLIPFLOP;case"Do":return F.DO_N;case"DoOnce":return F.DO_ONCE;case"IsValid":return F.IS_VALID;default:return F.MACRO}}}xe._DEFAULT_BACKGROUND_COLOR="150, 150, 150",xe._HEADLESS_NODES=[{name:"IncrementInt",displayName:"++"},{name:"DecrementInt",displayName:"--"},{name:"IncrementFloat",displayName:"++"},{name:"DecrementFloat",displayName:"--"}];class Se extends X{constructor(){super({FunctionReference:(e,t)=>{const i=new te;e.functionReference=i.parse(t),e.functionReference.memberName=e.functionReference.memberName.replace("UserConstructionScript","ConstructionScript"),e.backgroundColor=b.DEFAULT_FUNC_ENTRY_BACKGROUND_COLOR,e.class===y.FUNCTION_RESULT?e.title="Return Node":e.title=T(g(e.functionReference.memberName))}})}parse(e){return this.parseProperties(e),new $(e.node,F.CONSTRUCT)}}class we extends X{constructor(){super({bReturnByRefDesired:(e,t)=>{e.returnByRefDesired=!("False"===t)}})}parse(e){const t=e.node;return t.returnByRefDesired=!0,this.parseProperties(e),t.title="GET",t.subTitles.push({text:!0===t.returnByRefDesired?"a ref":"a copy"}),D.hidePinNames(t.customProperties),new Q(t)}}class Ie extends X{parse(e){return e.node.title="Make Array",e.node.backgroundColor=b.DEFAULT_FUNC_PURE_BACKGROUND_COLOR,new $(e.node,F.MAKE_ARRAY)}}class De extends X{parse(e){return e.node.title="Input Touch",e.node.backgroundColor=De._DEFAULT_BACKGROUND_COLOR,new $(e.node,F.INPUT_TOUCH)}}De._DEFAULT_BACKGROUND_COLOR="156, 36, 35";class be extends X{constructor(){super({InputAxisKey:(e,t)=>{e.inputAxisKey=t}})}parse(e){this.parseProperties(e),e.node.backgroundColor=b.DEFAULT_FUNC_PURE_BACKGROUND_COLOR;let t=e.node;t.title="Get "+T(t.inputAxisKey);let i=F.FUNCTION;return t.inputAxisKey.startsWith("Mouse")&&(i=F.MOUSE),new $(e.node,i)}}class Re extends X{constructor(){super({StructType:(e,t)=>{e.structType=te.parseClassReference(t)}})}parse(e){this.parseProperties(e),e.node.backgroundColor=Re._DEFAULT_BACKGROUND_COLOR;const t=e.node;let i="",s=F.PILL;switch(e.node.class){case y.SET_FIELDS_IN_STRUCT:i="Set members in ";break;case y.BREAK_STRUCT:i="Break ",s=F.BREAK_STRUCT;break;case y.MAKE_STRUCT:i="Make ",s=F.MAKE_STRUCT}return t.title=i+t.structType.className,new $(e.node,s)}}Re._DEFAULT_BACKGROUND_COLOR="19, 42, 79";class Le extends X{constructor(){super({IndexPinType:(e,t)=>{let i,s,n=(t=t.replace(/[()]/g,"")).split(",");for(let e of n){let t=e.split("=");"PinCategory"==t[0]&&(i=t[1].replace('"',"")),"PinSubCategory"==t[0]&&(s=t[1].replace('"',""))}e.indexPinType={category:i,subCategory:s}}})}parse(e){return this.parseProperties(e),e.node.title="Select",e.node.backgroundColor=b.DEFAULT_FUNC_PURE_BACKGROUND_COLOR,Le.changePinsToReference(e),new $(e.node,F.SELECT)}static changePinsToReference(e){for(let t of e.node.customProperties)t instanceof m&&"index"!==t.name.toLowerCase()&&(t.isReference=!0)}}class Me extends X{constructor(){super({TimelineName:(e,t)=>{e.title=D.parseString(t)}})}parse(e){return this.parseProperties(e),e.node.backgroundColor=Me.DEFAULT_BACKGROUND_COLOR,new $(e.node,F.TIMER)}}Me.DEFAULT_BACKGROUND_COLOR="138, 108, 19";class Ue extends X{parse(e){const t=D.getFirstClassNameFromPinProperties(e.node.customProperties)||"";return e.node.title=`Spawn Actor ${E(t)}`,new ne(e.node,F.SPAWN_ACTOR)}}class Fe extends X{constructor(){super({bCanHaveInputs:(e,t)=>{"true"===t.toLowerCase()&&(e.title="Outputs")},bCanHaveOutputs:(e,t)=>{"true"===t.toLowerCase()&&(e.title="Inputs")}})}parse(e){return this.parseProperties(e),e.node.backgroundColor=b.DEFAULT_FUNC_BACKGROUND_COLOR,new $(e.node,F.CONSTRUCT)}}class ve extends X{parse(e){const t=D.getFirstClassNameFromPinProperties(e.node.customProperties)||"User ";return e.node.title=`Create ${E(t)} Widget`,new $(e.node,F.CONSTRUCT)}}class Be extends X{parse(e){const t=D.getFirstClassNameFromPinProperties(e.node.customProperties)||"";return e.node.title=`Create ${E(t)}`,new $(e.node,F.CONSTRUCT)}}class Ge extends X{constructor(){super({NodeGuid:(e,t)=>{e.guid=t},NodePosX:(e,t)=>{e.pos.x=Number.parseInt(t)},NodePosY:(e,t)=>{e.pos.y=Number.parseInt(t)},AdvancedPinDisplay:(e,t)=>{e.advancedPinDisplay="Shown"===t},EnabledState:(e,t)=>{e.enabledState=t},ErrorType:(e,t)=>{e.errorType=Number.parseInt(t)},ErrorMsg:(e,t)=>{e.errorMsg=t.replace(/["]/g,"").replace(/\\\'/g,"'")}}),this._OBJECT_STARTING_TAG="Begin Object",this._nodeParsers={[y.KNOT]:()=>new Ee,[y.CALL_FUNCTION]:()=>new le,[y.IF_THEN_ELSE]:()=>new Te,[y.EXECUTION_SEQUENCE]:()=>new Te,[y.MULTI_GATE]:()=>new Te,[y.VARIABLE_GET]:()=>new he,[y.VARIABLE_SET]:()=>new he,[y.EVENT]:()=>new Ce,[y.CUSTOM_EVENT]:()=>new Ne,[y.INPUT_AXIS_EVENT]:()=>new ae,[y.COMMENT]:()=>new j,[y.INPUT_KEY]:()=>new ye,[y.CommutativeAssociativeBinaryOperator]:()=>new le,[y.DYNAMIC_CAST]:()=>new Pe,[y.SWITCH_ENUM]:()=>new Oe,[y.MACRO_INSTANCE]:()=>new xe,[y.FUNCTION_ENTRY]:()=>new Se,[y.FUNCTION_RESULT]:()=>new Se,[y.CALL_ARRAY_FUNCTION]:()=>new le,[y.SELF]:()=>new he,[y.GET_ARRAY_ITEM]:()=>new we,[y.MAKE_ARRAY]:()=>new Ie,[y.INPUT_TOUCH]:()=>new De,[y.GET_INPUT_AXIS_KEY_VALUE]:()=>new be,[y.SET_FIELDS_IN_STRUCT]:()=>new Re,[y.BREAK_STRUCT]:()=>new Re,[y.MAKE_STRUCT]:()=>new Re,[y.SELECT]:()=>new Le,[y.TIMELINE]:()=>new Me,[y.SPAWN_ACTOR_FROM_CLASS]:()=>new Ue,[y.TUNNEL]:()=>new Fe,[y.CREATE_WIDGET]:()=>new ve,[y.CREATE_OBJECT]:()=>new Be},this._customPropertyParsers={Pin:()=>new fe}}parse(e){const t=e.lines[0],i=this.parseHeader(t);e.node={class:i.class,name:i.name,title:i.name,subTitles:[],guid:void 0,pos:new d(0,0),sourceText:e.lines.join("\n"),customProperties:[],latent:!1},this.parseProperties(e),this.parseCustomProperties(e);const s=this._nodeParsers[e.node.class];if(!s)return console.info(`There is no particular implementation for class ${e.node.class}. Falling back to the generic node class.`),new $(e.node);return s().parse(e)}parseHeader(e){let t={};const i=this._OBJECT_STARTING_TAG.length;return(e.substr(i,e.length-i-1).trim().split(" ")||[]).forEach((e=>(e=>{const i=e.split("=");t[i[0]]=i[1].replace(/"/g,"")})(e))),{class:t.Class,name:t.Name}}parseCustomProperties(e){for(const t of e.unparsedLines)if(t.startsWith("CustomProperties")){const i=this.parseCustomProperty(t,e.node.name);if(!i)continue;e.node.customProperties.push(i),i instanceof m&&i.subCategoryObject.class===O.LatentActionInfo&&(e.node.latent=!0)}this.hideExecPins(e.node)}parseCustomProperty(e,t){let i=(e=e.substr("CustomProperties".length).trim()).split(" "),s=i.shift(),n=i.join(" ");n=n.trim(),n=n.substr(1,n.length-2);const r=this._customPropertyParsers[s];if(!r)return void console.info(`There is no implementation for custom property type '${s}'. Skip this property`);return r().parse(n,t)}hideExecPins(e){let t={[l.EGPD_Input]:new Array,[l.EGPD_Output]:new Array};for(const i of e.customProperties)i instanceof m&&null!=i.direction&&i.category===o.exec&&t[i.direction].push(i);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const i=t[e];1==i.length&&(i[0].hideName=!0)}}}class ke{constructor(e){this._lines=Array.from(e),this._unparsedLines=e.slice(1,e.length-1)}get node(){return this._node}set node(e){this._node=e}get lines(){return this._lines}get unparsedLines(){return this._unparsedLines}}class He{constructor(){this._OBJECT_STARTING_TAG="Begin Object",this._OBJECT_ENDING_TAG="End Object"}parseBlueprint(e){let t=new Array;this._lines=e.replace(/\r/g,"").split("\n");for(let e=0;e<this._lines.length;++e){let i=D.stripLine(this._lines[e]);if(i.startsWith(this._OBJECT_STARTING_TAG)){const s=this.getLinesUntilEndTag(e);e+=s.length,s.unshift(i),t.push((new Ge).parse(new ke(s)))}}return t}getLinesUntilEndTag(e){let t=Array(),i="";do{if(++e>=this._lines.length)throw new Error("Invalid blueprint text. An 'Object' node was never closed. Missing 'End Object'");if(i=D.stripLine(this._lines[e]),i.startsWith(this._OBJECT_STARTING_TAG))throw new Error("Invalid blueprint text. An 'Object' node was opened before the previous was closed. Missing 'End Object'");t.push(i)}while(!i.startsWith(this._OBJECT_ENDING_TAG));return t}}class Ze{constructor(e){this._canvas=e,this._position=new d(0,0)}get position(){return this._position}prepareViewport(){this._canvas.translate(Math.round(this._position.x),Math.round(this._position.y))}moveRelative(e){this._position=this._position.add(e)}centerAbsolutePosition(e){this._position=new d(Math.round(e.x+this._canvas.width/2),Math.round(e.y+this._canvas.height/2))}}class Ve extends L{constructor(e){super(0,0,-1e3),this.camera=e,this.ready=!1,this.image=new Image,this.image.onload=e=>this.onLoaded(e),this.image.src=Ve.BACKGROUND_SVG}initialize(){this.loaded&&this.initPattern()}draw(e){this.ready&&e.fillStyle(this.pattern).fillRect(-this.camera.position.x,-this.camera.position.y,e.width,e.height)}onLoaded(e){this.loaded=!0,this.app&&this.initPattern()}initPattern(){this.pattern=this.app.canvas.getContext().createPattern(this.image,"repeat"),this.ready=!0,this.app.scene.refresh()}}Ve.BACKGROUND_SVG="data:image/svg+xml,"+escape('<svg width="96px" height="96px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect x="0" y="0" width="96.375" height="96" style="fill:#262626;stroke:#262626;stroke-width:0.75px;"/><g>        <path d="M96.375,48.389l-96,-0" style="fill:none;stroke:#353535;stroke-width:0.75px;"/>        <path d="M96.375,60.389l-96,-0" style="fill:none;stroke:#353535;stroke-width:0.75px;"/>        <path d="M96.375,72.389l-96,-0" style="fill:none;stroke:#353535;stroke-width:0.75px;"/>        <path d="M96.375,84.389l-96,-0" style="fill:none;stroke:#353535;stroke-width:0.75px;"/>        <path d="M96.375,36.389l-96,-0" style="fill:none;stroke:#353535;stroke-width:0.75px;"/>        <path d="M96.375,24.389l-96,-0" style="fill:none;stroke:#353535;stroke-width:0.75px;"/>        <path d="M96.375,12.389l-96,-0" style="fill:none;stroke:#353535;stroke-width:0.75px;"/></g><path d="M48.375,96l-0,-96" style="fill:none;stroke:#353535;stroke-width:0.75px;"/><path d="M36.375,96l-0,-96" style="fill:none;stroke:#353535;stroke-width:0.75px;"/><path d="M24.375,96l-0,-96" style="fill:none;stroke:#353535;stroke-width:0.75px;"/><path d="M12.375,96l-0,-96" style="fill:none;stroke:#353535;stroke-width:0.75px;"/><path d="M60.375,96l-0,-96" style="fill:none;stroke:#353535;stroke-width:0.75px;"/><path d="M72.375,96l-0,-96" style="fill:none;stroke:#353535;stroke-width:0.75px;"/><path d="M84.375,96l-0,-96" style="fill:none;stroke:#353535;stroke-width:0.75px;"/><path d="M96,0l-96,0l0,96" style="fill:none;stroke:#161616;stroke-width:1.55px;"/></svg>');class Ke extends M{constructor(e,t){super(0,0,-1),this.pinStart=e,this.pinEnd=t,this.pinStartPosition=this.pinStart.getPinAbsolutePosition(),this.pinEndPosition=this.pinEnd.getPinAbsolutePosition();let i=this.pinEndPosition.subtract(this.pinStartPosition),s=Math.sqrt(i.x*i.x+i.y*i.y)-12;this.curveValue=.4*s,this.color=U.getPinColor(this.pinStart.pinProperty),this.lineWidth=this.pinStart.pinProperty.category===o.exec?2.5:1.5}onDraw(e){this.pinStartPosition=this.pinStart.getPinAbsolutePosition(),this.pinEndPosition=this.pinEnd.getPinAbsolutePosition();let t=this.pinEndPosition.subtract(this.pinStartPosition),i=Math.sqrt(t.x*t.x+t.y*t.y)-12;this.curveValue=.4*i,e.lineWidth(this.lineWidth).beginPath().moveTo(this.pinStartPosition.x,this.pinStartPosition.y).strokeStyle(this.color).lineTo(this.pinStartPosition.x+6,this.pinStartPosition.y).bezierCurveTo(this.pinStartPosition.x+this.curveValue+6,this.pinStartPosition.y,this.pinEndPosition.x-this.curveValue-6,this.pinEndPosition.y,this.pinEndPosition.x-6,this.pinEndPosition.y).lineTo(this.pinEndPosition.x,this.pinEndPosition.y).stroke()}}class ze extends L{constructor(e){super(e.getAbsolutPosition().x,e.getAbsolutPosition().y,-1),this._pin=e,this._color=U.getPinColor(this._pin.pinProperty),this._isDirectionOutput=this._pin.pinProperty.direction==l.EGPD_Output,this._lineWidth=this._pin.pinProperty.category===o.exec?2.5:1.5}draw(e){e.save(),e.translate(this._pin.getPinAbsolutePosition().x,this._pin.getPinAbsolutePosition().y),e.lineWidth(this._lineWidth).beginPath().setLineDash([30,4,2.5,4,2.5,4,2.5]),this._isDirectionOutput?e.moveTo(6,0).lineTo(ze.LINE_LENGTH,0):e.moveTo(-6,0).lineTo(-ze.LINE_LENGTH,0),e.strokeStyle(this._color).stroke(),e.restore()}}ze.LINE_LENGTH=80;class We{constructor(e,t){this.app=t,this._canvas=e,this._camera=new Ze(this._canvas),this._nodes=new Array,this._controls=new Array,this._pins=new Array}get camera(){return this._camera}get canvas(){return this._canvas}get nodes(){return this._nodes||[]}get interactables(){return this._interactables||[]}collectInteractables(){let e=[];this._controls.forEach((t=>{t instanceof ie&&e.push(t),t instanceof B&&this.findInteractablesIn(e,t)})),this._interactables=e}findInteractablesIn(e,t){for(let i of t.getChildren())i instanceof ie&&e.push(i),i instanceof B&&this.findInteractablesIn(e,i)}updateLayout(){this._controls.forEach((e=>{e instanceof M&&e.refreshLayout()}))}refresh(){this._canvas.clear(),this._controls.sort(((e,t)=>e.ZIndex-t.ZIndex)),this._camera.prepareViewport(),this._controls.forEach((e=>{void 0!==e.draw&&e.draw(this._canvas)}))}unload(){this._pins=new Array,this._nodes=new Array,this._controls=new Array}load(e){this.createBackground(),this.createControlNodes(e),this.createConnectionLines(),this.initializeControls()}createBackground(){let e=new Ve(this.camera);this._controls.push(e)}createControlNodes(e){for(const t of e)this._nodes.push(t),this._controls.push(t),this.collectPins(t)}collectPins(e){if(e instanceof B)for(let t of e.getChildren())t instanceof v&&this._pins.push(t),t instanceof B&&this.collectPins(t)}createConnectionLines(){const e=[],t=this._pins;for(let i=t.length-1;i>=0;--i){let s=t[i];if(!s.pinProperty.isLinked){t.splice(i,1);continue}if(s.pinProperty.direction!=l.EGPD_Output)continue;let n=!1;for(let i=0;i<s.pinProperty.linkedTo.length;++i){let r=s.pinProperty.linkedTo[i],o=t.find((e=>e.pinProperty.nodeName===r.nodeName&&e.pinProperty.id===r.pinID));o&&(this._controls.push(new Ke(s,o)),e.push(s.pinProperty.getUniqueName()),e.push(o.pinProperty.getUniqueName()),n=!0)}n&&t.splice(i,1)}for(let i=t.length-1;i>=0;--i){let s=t[i];if(!(e.indexOf(s.pinProperty.getUniqueName())>=0)&&s.pinProperty.isLinked){let e=new ze(s);this._controls.push(e)}}}initializeControls(){for(let e of this._controls)this.initializeControl(e)}initializeControl(e){if(e.initControl(this.app),e instanceof B)for(let t of e.getChildren())this.initializeControl(t)}calculateCentroid(){let e=new d(0,0);return 0==this.nodes.length?e:(this.nodes.forEach((t=>{e=new d(e.x-t.position.x-.5*t.size.x,e.y-t.position.y-.5*t.size.y)})),new d(e.x/this.nodes.length,e.y/this.nodes.length))}calculateCenterPoint(){if(0==this.nodes.length)return new d(0,0);let e=Number.MAX_SAFE_INTEGER,t=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER;return this.nodes.forEach((n=>{e=Math.min(n.position.x,e),i=Math.min(n.position.y,i),t=Math.max(n.position.x+n.size.x,t),s=Math.max(n.position.y+n.size.y,s)})),new d(.5*-(t-e)-e,.5*-(s-i)-i)}}class Xe{constructor(e){this._element=e,navigator.userAgent.indexOf("Firefox")>0&&(Xe.firefox=!0),this._canvas=new c(e),this._scene=new We(this._canvas,this),this.initializeHtmlAttributes(),this._parser=new He,this.loadBlueprintIntoScene(e.innerHTML),this._controller=new u(e,this),this._controller.registerAction({ctrl:!0,keycode:"KeyC",callback:this.copyBlueprintSelectionToClipboard.bind(this)}),this._controller.registerAction({ctrl:!1,keycode:"Home",callback:this.recenterCamera.bind(this)}),this._controller.registerAction({ctrl:!0,keycode:"KeyV",callback:this.pasteClipboardContentToCanvas.bind(this)}),this._element.onpaste=e=>this.onPaste(e),window.addEventListener("resize",this.refresh.bind(this),!1)}get scene(){return this._scene}get canvas(){return this._canvas}static get isFirefox(){return this.firefox}getBlueprint(){let e=[];return this._scene.nodes.forEach((t=>e=[].concat(e,t.sourceText))),e.join("\n")}initializeHtmlAttributes(){this._element.style.outline="none";let e=this._element.getAttributeNode("data-klee-paste");this.allowPaste="true"==e?.value||!1}refresh(){this._element.width=this._element.offsetWidth,this._element.height=this._element.offsetHeight,this._scene.collectInteractables(),this._scene.updateLayout(),this._scene.refresh()}copyBlueprintSelectionToClipboard(){console.log("Copy selection");let e=[];return this._scene.nodes.filter((e=>e.selected)).forEach((t=>e=[].concat(e,t.sourceText))),navigator.clipboard.writeText(e.join("\n")),!0}pasteClipboardContentToCanvas(e){if(this.allowPaste)return!Xe.isFirefox&&(console.log("Paste from clipboard"),navigator.clipboard.readText().then((e=>{e&&this.loadBlueprintIntoScene(e)})),!0)}onPaste(e){if(!this.allowPaste)return;console.log("Paste from clipboard");let t=e.clipboardData.getData("text/plain");this.loadBlueprintIntoScene(t)}loadBlueprintIntoScene(e){this._scene.unload();const t=this._parser.parseBlueprint(e);this._scene.load(t),this.refresh(),this.recenterCamera()}recenterCamera(){return this._scene.camera.centerAbsolutePosition(this._scene.calculateCenterPoint()),this.refresh(),!0}static registerInstance(e,t){e.setAttribute("data-klee-instance",Xe.instances.length.toString()),Xe.instances.push(t)}static getInstance(e){let t=e.getAttributeNode("data-klee-instance");if(t){let e=Number.parseInt(t.value);if(!isNaN(e)&&e<Xe.instances.length){return Xe.instances[e]}}}static createOrGet(e){let t=this.getInstance(e);if(void 0!==t)return t;let i=new Xe(e);return Xe.registerInstance(e,i),i}}Xe.instances=[];class je{constructor(e,t){this.app=void 0!==t?t:Xe.createOrGet(e)}display(e){this.app.loadBlueprintIntoScene(e)}static getInstance(e){let t=Xe.getInstance(e);if(void 0!==t)return new je(e,t)}get value(){return this.app.getBlueprint()}}function Ye(e){return new je(e)}function qe(e){return je.getInstance(e)}return window.addEventListener("load",(function(){document.querySelectorAll("canvas.klee").forEach((e=>{new je(e)}))})),a})()));